import{f as Ol,g as ln,h as Si,m as Dl,n as Ri,p as Ml,u as Ll}from"./chunk-GSRJXHD3.js";import{d as Nl,f as Pl}from"./chunk-52S7DBCA.js";import"./chunk-IX6G3U3V.js";import{a as xl}from"./chunk-PVDU4PFS.js";import{A as Tl,B as kl,C as Il,D as Ii,E as Sl,G as Rl,S as Al,b as il,c as ui,d as rl,e as hi,f as sl,h as ol,i as al,l as Zr,m as yi,n as bi,o as wi,p as is,q as Ie,r as Ei,s as Ci,t as Ti,u as yl,v as ki,w as bl,x as wl,y as El,z as Cl}from"./chunk-LPSJYQ4T.js";import{E as qa,G as Ya,I as Ka,Ia as oi,Ja as sn,O as Qr,P as Qa,Ra as tl,S as Xa,Ta as ai,U as Ct,Va as li,Xa as Jr,Ya as Ve,Z as Ja,_ as Za,ba as ye,c as ri,ca as ie,ea as He,ga as S,h as Ga,ha as si,ic as ci,m as nn,ma as Xr,mb as nl,n as rn,na as re,pa as el,r as fe,z as Kr}from"./chunk-5J3ZMGMD.js";import{A as b,B as se,C as V,D as ts,E as _l,F as an,G as U,H as ke,I as mi,J as ns,K as vl,L as gi,M as _i,N as vi,P as kt,Q as Le,a as m,b as Tt,c as ll,d as cl,e as ul,f as X,g as di,i as es,j as hl,k as Te,n as dl,p as fi,q as H,r as fl,s as pl,t as pe,u as $e,v as pi,w as on,y as ml,z as gl}from"./chunk-FNBMN5FH.js";import{a as Va,b as $a,f as at}from"./chunk-CQCHLVVT.js";var rf=fe(t=>!!t),Fl=(()=>{class t{router;auth;constructor(n,i){this.router=n,this.auth=i}canActivate=(n,i)=>{let r=n.data.authGuardPipe||(()=>rf);return this.auth.user.pipe(Ya(1),r(n,i),fe(s=>typeof s=="boolean"?s:Array.isArray(s)?this.router.createUrlTree(s):this.router.parseUrl(s)))};static \u0275fac=function(i){return new(i||t)(S(al),S(Ii))};static \u0275prov=ye({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var sf=[{path:"pages",loadChildren:()=>import("./chunk-E6HLX4SJ.js").then(t=>t.PagesModule),canActivate:[Fl]},{path:"",loadChildren:()=>import("./chunk-MEQRRW5N.js").then(t=>t.AuthModule)},{path:"**",redirectTo:""}],Ul=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=re({type:e}),e.\u0275inj=ie({imports:[Zr.forRoot(sf),Zr]});let t=e;return t})();var Wl=(()=>{let e=class e{constructor(){this.title="idiomas-web-try2"}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=Xr({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(r,s){r&1&&nl(0,"router-outlet")},dependencies:[ol]});let t=e;return t})();function jl(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?jl(Object(n),!0).forEach(function(i){$(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jl(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function ji(t){"@babel/helpers - typeof";return ji=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ji(t)}function of(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bl(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function af(t,e,n){return e&&Bl(t.prototype,e),n&&Bl(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function $(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ys(t,e){return cf(t)||hf(t,e)||dc(t,e)||ff()}function _n(t){return lf(t)||uf(t)||dc(t)||df()}function lf(t){if(Array.isArray(t))return ls(t)}function cf(t){if(Array.isArray(t))return t}function uf(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function hf(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,o,a;try{for(n=n.call(t);!(r=(o=n.next()).done)&&(i.push(o.value),!(e&&i.length===e));r=!0);}catch(l){s=!0,a=l}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw a}}return i}}function dc(t,e){if(t){if(typeof t=="string")return ls(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ls(t,e)}}function ls(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function df(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ff(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var zl=function(){},bs={},fc={},pc=null,mc={mark:zl,measure:zl};try{typeof window<"u"&&(bs=window),typeof document<"u"&&(fc=document),typeof MutationObserver<"u"&&(pc=MutationObserver),typeof performance<"u"&&(mc=performance)}catch{}var pf=bs.navigator||{},Hl=pf.userAgent,Vl=Hl===void 0?"":Hl,Ye=bs,M=fc,$l=pc,xi=mc,Ny=!!Ye.document,je=!!M.documentElement&&!!M.head&&typeof M.addEventListener=="function"&&typeof M.createElement=="function",gc=~Vl.indexOf("MSIE")||~Vl.indexOf("Trident/"),Ai,Ni,Pi,Oi,Di,Fe="___FONT_AWESOME___",cs=16,_c="fa",vc="svg-inline--fa",ut="data-fa-i2svg",us="data-fa-pseudo-element",mf="data-fa-pseudo-element-pending",ws="data-prefix",Es="data-icon",Gl="fontawesome-i2svg",gf="async",_f=["HTML","HEAD","STYLE","SCRIPT"],yc=function(){try{return!0}catch{return!1}}(),D="classic",B="sharp",Cs=[D,B];function vn(t){return new Proxy(t,{get:function(n,i){return i in n?n[i]:n[D]}})}var dn=vn((Ai={},$(Ai,D,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit",fakd:"kit","fa-kit":"kit","fa-kit-duotone":"kit"}),$(Ai,B,{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"}),Ai)),fn=vn((Ni={},$(Ni,D,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),$(Ni,B,{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"}),Ni)),pn=vn((Pi={},$(Pi,D,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),$(Pi,B,{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"}),Pi)),vf=vn((Oi={},$(Oi,D,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),$(Oi,B,{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"}),Oi)),yf=/fa(s|r|l|t|d|b|k|ss|sr|sl|st)?[\-\ ]/,bc="fa-layers-text",bf=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,wf=vn((Di={},$(Di,D,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),$(Di,B,{900:"fass",400:"fasr",300:"fasl",100:"fast"}),Di)),wc=[1,2,3,4,5,6,7,8,9,10],Ef=wc.concat([11,12,13,14,15,16,17,18,19,20]),Cf=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],lt={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},mn=new Set;Object.keys(fn[D]).map(mn.add.bind(mn));Object.keys(fn[B]).map(mn.add.bind(mn));var Tf=[].concat(Cs,_n(mn),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",lt.GROUP,lt.SWAP_OPACITY,lt.PRIMARY,lt.SECONDARY]).concat(wc.map(function(t){return"".concat(t,"x")})).concat(Ef.map(function(t){return"w-".concat(t)})),un=Ye.FontAwesomeConfig||{};function kf(t){var e=M.querySelector("script["+t+"]");if(e)return e.getAttribute(t)}function If(t){return t===""?!0:t==="false"?!1:t==="true"?!0:t}M&&typeof M.querySelector=="function"&&(ql=[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]],ql.forEach(function(t){var e=ys(t,2),n=e[0],i=e[1],r=If(kf(n));r!=null&&(un[i]=r)}));var ql,Ec={styleDefault:"solid",familyDefault:"classic",cssPrefix:_c,replacementClass:vc,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};un.familyPrefix&&(un.cssPrefix=un.familyPrefix);var xt=g(g({},Ec),un);xt.autoReplaceSvg||(xt.observeMutations=!1);var _={};Object.keys(Ec).forEach(function(t){Object.defineProperty(_,t,{enumerable:!0,set:function(n){xt[t]=n,hn.forEach(function(i){return i(_)})},get:function(){return xt[t]}})});Object.defineProperty(_,"familyPrefix",{enumerable:!0,set:function(e){xt.cssPrefix=e,hn.forEach(function(n){return n(_)})},get:function(){return xt.cssPrefix}});Ye.FontAwesomeConfig=_;var hn=[];function Sf(t){return hn.push(t),function(){hn.splice(hn.indexOf(t),1)}}var qe=cs,Se={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function Rf(t){if(!(!t||!je)){var e=M.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=t;for(var n=M.head.childNodes,i=null,r=n.length-1;r>-1;r--){var s=n[r],o=(s.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(i=s)}return M.head.insertBefore(e,i),t}}var xf="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function gn(){for(var t=12,e="";t-- >0;)e+=xf[Math.random()*62|0];return e}function At(t){for(var e=[],n=(t||[]).length>>>0;n--;)e[n]=t[n];return e}function Ts(t){return t.classList?At(t.classList):(t.getAttribute("class")||"").split(" ").filter(function(e){return e})}function Cc(t){return"".concat(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Af(t){return Object.keys(t||{}).reduce(function(e,n){return e+"".concat(n,'="').concat(Cc(t[n]),'" ')},"").trim()}function Hi(t){return Object.keys(t||{}).reduce(function(e,n){return e+"".concat(n,": ").concat(t[n].trim(),";")},"")}function ks(t){return t.size!==Se.size||t.x!==Se.x||t.y!==Se.y||t.rotate!==Se.rotate||t.flipX||t.flipY}function Nf(t){var e=t.transform,n=t.containerWidth,i=t.iconWidth,r={transform:"translate(".concat(n/2," 256)")},s="translate(".concat(e.x*32,", ").concat(e.y*32,") "),o="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)"),l={transform:"".concat(s," ").concat(o," ").concat(a)},c={transform:"translate(".concat(i/2*-1," -256)")};return{outer:r,inner:l,path:c}}function Pf(t){var e=t.transform,n=t.width,i=n===void 0?cs:n,r=t.height,s=r===void 0?cs:r,o=t.startCentered,a=o===void 0?!1:o,l="";return a&&gc?l+="translate(".concat(e.x/qe-i/2,"em, ").concat(e.y/qe-s/2,"em) "):a?l+="translate(calc(-50% + ".concat(e.x/qe,"em), calc(-50% + ").concat(e.y/qe,"em)) "):l+="translate(".concat(e.x/qe,"em, ").concat(e.y/qe,"em) "),l+="scale(".concat(e.size/qe*(e.flipX?-1:1),", ").concat(e.size/qe*(e.flipY?-1:1),") "),l+="rotate(".concat(e.rotate,"deg) "),l}var Of=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-counter-scale, 0.25));
          transform: scale(var(--fa-counter-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom right;
          transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom left;
          transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top left;
          transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(var(--fa-li-width, 2em) * -1);
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  -webkit-animation-name: fa-beat;
          animation-name: fa-beat;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  -webkit-animation-name: fa-bounce;
          animation-name: fa-bounce;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  -webkit-animation-name: fa-fade;
          animation-name: fa-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  -webkit-animation-name: fa-beat-fade;
          animation-name: fa-beat-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  -webkit-animation-name: fa-flip;
          animation-name: fa-flip;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  -webkit-animation-name: fa-shake;
          animation-name: fa-shake;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-delay: var(--fa-animation-delay, 0s);
          animation-delay: var(--fa-animation-delay, 0s);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 2s);
          animation-duration: var(--fa-animation-duration, 2s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));
          animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    -webkit-animation-delay: -1ms;
            animation-delay: -1ms;
    -webkit-animation-duration: 1ms;
            animation-duration: 1ms;
    -webkit-animation-iteration-count: 1;
            animation-iteration-count: 1;
    -webkit-transition-delay: 0s;
            transition-delay: 0s;
    -webkit-transition-duration: 0s;
            transition-duration: 0s;
  }
}
@-webkit-keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@-webkit-keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@-webkit-keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@-webkit-keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@-webkit-keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@-webkit-keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  -webkit-transform: rotate(90deg);
          transform: rotate(90deg);
}

.fa-rotate-180 {
  -webkit-transform: rotate(180deg);
          transform: rotate(180deg);
}

.fa-rotate-270 {
  -webkit-transform: rotate(270deg);
          transform: rotate(270deg);
}

.fa-flip-horizontal {
  -webkit-transform: scale(-1, 1);
          transform: scale(-1, 1);
}

.fa-flip-vertical {
  -webkit-transform: scale(1, -1);
          transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  -webkit-transform: scale(-1, -1);
          transform: scale(-1, -1);
}

.fa-rotate-by {
  -webkit-transform: rotate(var(--fa-rotate-angle, none));
          transform: rotate(var(--fa-rotate-angle, none));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}

.fad.fa-inverse,
.fa-duotone.fa-inverse {
  color: var(--fa-inverse, #fff);
}`;function Tc(){var t=_c,e=vc,n=_.cssPrefix,i=_.replacementClass,r=Of;if(n!==t||i!==e){var s=new RegExp("\\.".concat(t,"\\-"),"g"),o=new RegExp("\\--".concat(t,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");r=r.replace(s,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(a,".".concat(i))}return r}var Yl=!1;function rs(){_.autoAddCss&&!Yl&&(Rf(Tc()),Yl=!0)}var Df={mixout:function(){return{dom:{css:Tc,insertCss:rs}}},hooks:function(){return{beforeDOMElementCreation:function(){rs()},beforeI2svg:function(){rs()}}}},Ue=Ye||{};Ue[Fe]||(Ue[Fe]={});Ue[Fe].styles||(Ue[Fe].styles={});Ue[Fe].hooks||(Ue[Fe].hooks={});Ue[Fe].shims||(Ue[Fe].shims=[]);var be=Ue[Fe],kc=[],Mf=function t(){M.removeEventListener("DOMContentLoaded",t),Bi=1,kc.map(function(e){return e()})},Bi=!1;je&&(Bi=(M.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(M.readyState),Bi||M.addEventListener("DOMContentLoaded",Mf));function Lf(t){je&&(Bi?setTimeout(t,0):kc.push(t))}function yn(t){var e=t.tag,n=t.attributes,i=n===void 0?{}:n,r=t.children,s=r===void 0?[]:r;return typeof t=="string"?Cc(t):"<".concat(e," ").concat(Af(i),">").concat(s.map(yn).join(""),"</").concat(e,">")}function Kl(t,e,n){if(t&&t[e]&&t[e][n])return{prefix:e,iconName:n,icon:t[e][n]}}var Ff=function(e,n){return function(i,r,s,o){return e.call(n,i,r,s,o)}},ss=function(e,n,i,r){var s=Object.keys(e),o=s.length,a=r!==void 0?Ff(n,r):n,l,c,u;for(i===void 0?(l=1,u=e[s[0]]):(l=0,u=i);l<o;l++)c=s[l],u=a(u,e[c],c,e);return u};function Uf(t){for(var e=[],n=0,i=t.length;n<i;){var r=t.charCodeAt(n++);if(r>=55296&&r<=56319&&n<i){var s=t.charCodeAt(n++);(s&64512)==56320?e.push(((r&1023)<<10)+(s&1023)+65536):(e.push(r),n--)}else e.push(r)}return e}function hs(t){var e=Uf(t);return e.length===1?e[0].toString(16):null}function Wf(t,e){var n=t.length,i=t.charCodeAt(e),r;return i>=55296&&i<=56319&&n>e+1&&(r=t.charCodeAt(e+1),r>=56320&&r<=57343)?(i-55296)*1024+r-56320+65536:i}function Ql(t){return Object.keys(t).reduce(function(e,n){var i=t[n],r=!!i.icon;return r?e[i.iconName]=i.icon:e[n]=i,e},{})}function ds(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=n.skipHooks,r=i===void 0?!1:i,s=Ql(e);typeof be.hooks.addPack=="function"&&!r?be.hooks.addPack(t,Ql(e)):be.styles[t]=g(g({},be.styles[t]||{}),s),t==="fas"&&ds("fa",e)}var Mi,Li,Fi,It=be.styles,jf=be.shims,Bf=(Mi={},$(Mi,D,Object.values(pn[D])),$(Mi,B,Object.values(pn[B])),Mi),Is=null,Ic={},Sc={},Rc={},xc={},Ac={},zf=(Li={},$(Li,D,Object.keys(dn[D])),$(Li,B,Object.keys(dn[B])),Li);function Hf(t){return~Tf.indexOf(t)}function Vf(t,e){var n=e.split("-"),i=n[0],r=n.slice(1).join("-");return i===t&&r!==""&&!Hf(r)?r:null}var Nc=function(){var e=function(s){return ss(It,function(o,a,l){return o[l]=ss(a,s,{}),o},{})};Ic=e(function(r,s,o){if(s[3]&&(r[s[3]]=o),s[2]){var a=s[2].filter(function(l){return typeof l=="number"});a.forEach(function(l){r[l.toString(16)]=o})}return r}),Sc=e(function(r,s,o){if(r[o]=o,s[2]){var a=s[2].filter(function(l){return typeof l=="string"});a.forEach(function(l){r[l]=o})}return r}),Ac=e(function(r,s,o){var a=s[2];return r[o]=o,a.forEach(function(l){r[l]=o}),r});var n="far"in It||_.autoFetchSvg,i=ss(jf,function(r,s){var o=s[0],a=s[1],l=s[2];return a==="far"&&!n&&(a="fas"),typeof o=="string"&&(r.names[o]={prefix:a,iconName:l}),typeof o=="number"&&(r.unicodes[o.toString(16)]={prefix:a,iconName:l}),r},{names:{},unicodes:{}});Rc=i.names,xc=i.unicodes,Is=Vi(_.styleDefault,{family:_.familyDefault})};Sf(function(t){Is=Vi(t.styleDefault,{family:_.familyDefault})});Nc();function Ss(t,e){return(Ic[t]||{})[e]}function $f(t,e){return(Sc[t]||{})[e]}function ct(t,e){return(Ac[t]||{})[e]}function Pc(t){return Rc[t]||{prefix:null,iconName:null}}function Gf(t){var e=xc[t],n=Ss("fas",t);return e||(n?{prefix:"fas",iconName:n}:null)||{prefix:null,iconName:null}}function Ke(){return Is}var Rs=function(){return{prefix:null,iconName:null,rest:[]}};function Vi(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.family,i=n===void 0?D:n,r=dn[i][t],s=fn[i][t]||fn[i][r],o=t in be.styles?t:null;return s||o||null}var Xl=(Fi={},$(Fi,D,Object.keys(pn[D])),$(Fi,B,Object.keys(pn[B])),Fi);function $i(t){var e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.skipLookups,r=i===void 0?!1:i,s=(e={},$(e,D,"".concat(_.cssPrefix,"-").concat(D)),$(e,B,"".concat(_.cssPrefix,"-").concat(B)),e),o=null,a=D;(t.includes(s[D])||t.some(function(c){return Xl[D].includes(c)}))&&(a=D),(t.includes(s[B])||t.some(function(c){return Xl[B].includes(c)}))&&(a=B);var l=t.reduce(function(c,u){var h=Vf(_.cssPrefix,u);if(It[u]?(u=Bf[a].includes(u)?vf[a][u]:u,o=u,c.prefix=u):zf[a].indexOf(u)>-1?(o=u,c.prefix=Vi(u,{family:a})):h?c.iconName=h:u!==_.replacementClass&&u!==s[D]&&u!==s[B]&&c.rest.push(u),!r&&c.prefix&&c.iconName){var d=o==="fa"?Pc(c.iconName):{},f=ct(c.prefix,c.iconName);d.prefix&&(o=null),c.iconName=d.iconName||f||c.iconName,c.prefix=d.prefix||c.prefix,c.prefix==="far"&&!It.far&&It.fas&&!_.autoFetchSvg&&(c.prefix="fas")}return c},Rs());return(t.includes("fa-brands")||t.includes("fab"))&&(l.prefix="fab"),(t.includes("fa-duotone")||t.includes("fad"))&&(l.prefix="fad"),!l.prefix&&a===B&&(It.fass||_.autoFetchSvg)&&(l.prefix="fass",l.iconName=ct(l.prefix,l.iconName)||l.iconName),(l.prefix==="fa"||o==="fa")&&(l.prefix=Ke()||"fas"),l}var qf=function(){function t(){of(this,t),this.definitions={}}return af(t,[{key:"add",value:function(){for(var n=this,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];var o=r.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(a){n.definitions[a]=g(g({},n.definitions[a]||{}),o[a]),ds(a,o[a]);var l=pn[D][a];l&&ds(l,o[a]),Nc()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(n,i){var r=i.prefix&&i.iconName&&i.icon?{0:i}:i;return Object.keys(r).map(function(s){var o=r[s],a=o.prefix,l=o.iconName,c=o.icon,u=c[2];n[a]||(n[a]={}),u.length>0&&u.forEach(function(h){typeof h=="string"&&(n[a][h]=c)}),n[a][l]=c}),n}}]),t}(),Jl=[],St={},Rt={},Yf=Object.keys(Rt);function Kf(t,e){var n=e.mixoutsTo;return Jl=t,St={},Object.keys(Rt).forEach(function(i){Yf.indexOf(i)===-1&&delete Rt[i]}),Jl.forEach(function(i){var r=i.mixout?i.mixout():{};if(Object.keys(r).forEach(function(o){typeof r[o]=="function"&&(n[o]=r[o]),ji(r[o])==="object"&&Object.keys(r[o]).forEach(function(a){n[o]||(n[o]={}),n[o][a]=r[o][a]})}),i.hooks){var s=i.hooks();Object.keys(s).forEach(function(o){St[o]||(St[o]=[]),St[o].push(s[o])})}i.provides&&i.provides(Rt)}),n}function fs(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];var s=St[t]||[];return s.forEach(function(o){e=o.apply(null,[e].concat(i))}),e}function ht(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var r=St[t]||[];r.forEach(function(s){s.apply(null,n)})}function We(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);return Rt[t]?Rt[t].apply(null,e):void 0}function ps(t){t.prefix==="fa"&&(t.prefix="fas");var e=t.iconName,n=t.prefix||Ke();if(e)return e=ct(n,e)||e,Kl(Oc.definitions,n,e)||Kl(be.styles,n,e)}var Oc=new qf,Qf=function(){_.autoReplaceSvg=!1,_.observeMutations=!1,ht("noAuto")},Xf={i2svg:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return je?(ht("beforeI2svg",e),We("pseudoElements2svg",e),We("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.autoReplaceSvgRoot;_.autoReplaceSvg===!1&&(_.autoReplaceSvg=!0),_.observeMutations=!0,Lf(function(){Zf({autoReplaceSvgRoot:n}),ht("watch",e)})}},Jf={icon:function(e){if(e===null)return null;if(ji(e)==="object"&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:ct(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&e.length===2){var n=e[1].indexOf("fa-")===0?e[1].slice(3):e[1],i=Vi(e[0]);return{prefix:i,iconName:ct(i,n)||n}}if(typeof e=="string"&&(e.indexOf("".concat(_.cssPrefix,"-"))>-1||e.match(yf))){var r=$i(e.split(" "),{skipLookups:!0});return{prefix:r.prefix||Ke(),iconName:ct(r.prefix,r.iconName)||r.iconName}}if(typeof e=="string"){var s=Ke();return{prefix:s,iconName:ct(s,e)||e}}}},oe={noAuto:Qf,config:_,dom:Xf,parse:Jf,library:Oc,findIconDefinition:ps,toHtml:yn},Zf=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.autoReplaceSvgRoot,i=n===void 0?M:n;(Object.keys(be.styles).length>0||_.autoFetchSvg)&&je&&_.autoReplaceSvg&&oe.dom.i2svg({node:i})};function Gi(t,e){return Object.defineProperty(t,"abstract",{get:e}),Object.defineProperty(t,"html",{get:function(){return t.abstract.map(function(i){return yn(i)})}}),Object.defineProperty(t,"node",{get:function(){if(je){var i=M.createElement("div");return i.innerHTML=t.html,i.children}}}),t}function ep(t){var e=t.children,n=t.main,i=t.mask,r=t.attributes,s=t.styles,o=t.transform;if(ks(o)&&n.found&&!i.found){var a=n.width,l=n.height,c={x:a/l/2,y:.5};r.style=Hi(g(g({},s),{},{"transform-origin":"".concat(c.x+o.x/16,"em ").concat(c.y+o.y/16,"em")}))}return[{tag:"svg",attributes:r,children:e}]}function tp(t){var e=t.prefix,n=t.iconName,i=t.children,r=t.attributes,s=t.symbol,o=s===!0?"".concat(e,"-").concat(_.cssPrefix,"-").concat(n):s;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:g(g({},r),{},{id:o}),children:i}]}]}function xs(t){var e=t.icons,n=e.main,i=e.mask,r=t.prefix,s=t.iconName,o=t.transform,a=t.symbol,l=t.title,c=t.maskId,u=t.titleId,h=t.extra,d=t.watchable,f=d===void 0?!1:d,p=i.found?i:n,v=p.width,y=p.height,A=r==="fak",I=[_.replacementClass,s?"".concat(_.cssPrefix,"-").concat(s):""].filter(function(de){return h.classes.indexOf(de)===-1}).filter(function(de){return de!==""||!!de}).concat(h.classes).join(" "),E={children:[],attributes:g(g({},h.attributes),{},{"data-prefix":r,"data-icon":s,class:I,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(v," ").concat(y)})},N=A&&!~h.classes.indexOf("fa-fw")?{width:"".concat(v/y*16*.0625,"em")}:{};f&&(E.attributes[ut]=""),l&&(E.children.push({tag:"title",attributes:{id:E.attributes["aria-labelledby"]||"title-".concat(u||gn())},children:[l]}),delete E.attributes.title);var z=g(g({},E),{},{prefix:r,iconName:s,main:n,mask:i,maskId:c,transform:o,symbol:a,styles:g(g({},N),h.styles)}),ne=i.found&&n.found?We("generateAbstractMask",z)||{children:[],attributes:{}}:We("generateAbstractIcon",z)||{children:[],attributes:{}},ve=ne.children,Me=ne.attributes;return z.children=ve,z.attributes=Me,a?tp(z):ep(z)}function Zl(t){var e=t.content,n=t.width,i=t.height,r=t.transform,s=t.title,o=t.extra,a=t.watchable,l=a===void 0?!1:a,c=g(g(g({},o.attributes),s?{title:s}:{}),{},{class:o.classes.join(" ")});l&&(c[ut]="");var u=g({},o.styles);ks(r)&&(u.transform=Pf({transform:r,startCentered:!0,width:n,height:i}),u["-webkit-transform"]=u.transform);var h=Hi(u);h.length>0&&(c.style=h);var d=[];return d.push({tag:"span",attributes:c,children:[e]}),s&&d.push({tag:"span",attributes:{class:"sr-only"},children:[s]}),d}function np(t){var e=t.content,n=t.title,i=t.extra,r=g(g(g({},i.attributes),n?{title:n}:{}),{},{class:i.classes.join(" ")}),s=Hi(i.styles);s.length>0&&(r.style=s);var o=[];return o.push({tag:"span",attributes:r,children:[e]}),n&&o.push({tag:"span",attributes:{class:"sr-only"},children:[n]}),o}var os=be.styles;function ms(t){var e=t[0],n=t[1],i=t.slice(4),r=ys(i,1),s=r[0],o=null;return Array.isArray(s)?o={tag:"g",attributes:{class:"".concat(_.cssPrefix,"-").concat(lt.GROUP)},children:[{tag:"path",attributes:{class:"".concat(_.cssPrefix,"-").concat(lt.SECONDARY),fill:"currentColor",d:s[0]}},{tag:"path",attributes:{class:"".concat(_.cssPrefix,"-").concat(lt.PRIMARY),fill:"currentColor",d:s[1]}}]}:o={tag:"path",attributes:{fill:"currentColor",d:s}},{found:!0,width:e,height:n,icon:o}}var ip={found:!1,width:512,height:512};function rp(t,e){!yc&&!_.showMissingIcons&&t&&console.error('Icon with name "'.concat(t,'" and prefix "').concat(e,'" is missing.'))}function gs(t,e){var n=e;return e==="fa"&&_.styleDefault!==null&&(e=Ke()),new Promise(function(i,r){var s={found:!1,width:512,height:512,icon:We("missingIconAbstract")||{}};if(n==="fa"){var o=Pc(t)||{};t=o.iconName||t,e=o.prefix||e}if(t&&e&&os[e]&&os[e][t]){var a=os[e][t];return i(ms(a))}rp(t,e),i(g(g({},ip),{},{icon:_.showMissingIcons&&t?We("missingIconAbstract")||{}:{}}))})}var ec=function(){},_s=_.measurePerformance&&xi&&xi.mark&&xi.measure?xi:{mark:ec,measure:ec},cn='FA "6.5.1"',sp=function(e){return _s.mark("".concat(cn," ").concat(e," begins")),function(){return Dc(e)}},Dc=function(e){_s.mark("".concat(cn," ").concat(e," ends")),_s.measure("".concat(cn," ").concat(e),"".concat(cn," ").concat(e," begins"),"".concat(cn," ").concat(e," ends"))},As={begin:sp,end:Dc},Ui=function(){};function tc(t){var e=t.getAttribute?t.getAttribute(ut):null;return typeof e=="string"}function op(t){var e=t.getAttribute?t.getAttribute(ws):null,n=t.getAttribute?t.getAttribute(Es):null;return e&&n}function ap(t){return t&&t.classList&&t.classList.contains&&t.classList.contains(_.replacementClass)}function lp(){if(_.autoReplaceSvg===!0)return Wi.replace;var t=Wi[_.autoReplaceSvg];return t||Wi.replace}function cp(t){return M.createElementNS("http://www.w3.org/2000/svg",t)}function up(t){return M.createElement(t)}function Mc(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.ceFn,i=n===void 0?t.tag==="svg"?cp:up:n;if(typeof t=="string")return M.createTextNode(t);var r=i(t.tag);Object.keys(t.attributes||[]).forEach(function(o){r.setAttribute(o,t.attributes[o])});var s=t.children||[];return s.forEach(function(o){r.appendChild(Mc(o,{ceFn:i}))}),r}function hp(t){var e=" ".concat(t.outerHTML," ");return e="".concat(e,"Font Awesome fontawesome.com "),e}var Wi={replace:function(e){var n=e[0];if(n.parentNode)if(e[1].forEach(function(r){n.parentNode.insertBefore(Mc(r),n)}),n.getAttribute(ut)===null&&_.keepOriginalSource){var i=M.createComment(hp(n));n.parentNode.replaceChild(i,n)}else n.remove()},nest:function(e){var n=e[0],i=e[1];if(~Ts(n).indexOf(_.replacementClass))return Wi.replace(e);var r=new RegExp("".concat(_.cssPrefix,"-.*"));if(delete i[0].attributes.id,i[0].attributes.class){var s=i[0].attributes.class.split(" ").reduce(function(a,l){return l===_.replacementClass||l.match(r)?a.toSvg.push(l):a.toNode.push(l),a},{toNode:[],toSvg:[]});i[0].attributes.class=s.toSvg.join(" "),s.toNode.length===0?n.removeAttribute("class"):n.setAttribute("class",s.toNode.join(" "))}var o=i.map(function(a){return yn(a)}).join(`
`);n.setAttribute(ut,""),n.innerHTML=o}};function nc(t){t()}function Lc(t,e){var n=typeof e=="function"?e:Ui;if(t.length===0)n();else{var i=nc;_.mutateApproach===gf&&(i=Ye.requestAnimationFrame||nc),i(function(){var r=lp(),s=As.begin("mutate");t.map(r),s(),n()})}}var Ns=!1;function Fc(){Ns=!0}function vs(){Ns=!1}var zi=null;function ic(t){if($l&&_.observeMutations){var e=t.treeCallback,n=e===void 0?Ui:e,i=t.nodeCallback,r=i===void 0?Ui:i,s=t.pseudoElementsCallback,o=s===void 0?Ui:s,a=t.observeMutationsRoot,l=a===void 0?M:a;zi=new $l(function(c){if(!Ns){var u=Ke();At(c).forEach(function(h){if(h.type==="childList"&&h.addedNodes.length>0&&!tc(h.addedNodes[0])&&(_.searchPseudoElements&&o(h.target),n(h.target)),h.type==="attributes"&&h.target.parentNode&&_.searchPseudoElements&&o(h.target.parentNode),h.type==="attributes"&&tc(h.target)&&~Cf.indexOf(h.attributeName))if(h.attributeName==="class"&&op(h.target)){var d=$i(Ts(h.target)),f=d.prefix,p=d.iconName;h.target.setAttribute(ws,f||u),p&&h.target.setAttribute(Es,p)}else ap(h.target)&&r(h.target)})}}),je&&zi.observe(l,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function dp(){zi&&zi.disconnect()}function fp(t){var e=t.getAttribute("style"),n=[];return e&&(n=e.split(";").reduce(function(i,r){var s=r.split(":"),o=s[0],a=s.slice(1);return o&&a.length>0&&(i[o]=a.join(":").trim()),i},{})),n}function pp(t){var e=t.getAttribute("data-prefix"),n=t.getAttribute("data-icon"),i=t.innerText!==void 0?t.innerText.trim():"",r=$i(Ts(t));return r.prefix||(r.prefix=Ke()),e&&n&&(r.prefix=e,r.iconName=n),r.iconName&&r.prefix||(r.prefix&&i.length>0&&(r.iconName=$f(r.prefix,t.innerText)||Ss(r.prefix,hs(t.innerText))),!r.iconName&&_.autoFetchSvg&&t.firstChild&&t.firstChild.nodeType===Node.TEXT_NODE&&(r.iconName=t.firstChild.data)),r}function mp(t){var e=At(t.attributes).reduce(function(r,s){return r.name!=="class"&&r.name!=="style"&&(r[s.name]=s.value),r},{}),n=t.getAttribute("title"),i=t.getAttribute("data-fa-title-id");return _.autoA11y&&(n?e["aria-labelledby"]="".concat(_.replacementClass,"-title-").concat(i||gn()):(e["aria-hidden"]="true",e.focusable="false")),e}function gp(){return{iconName:null,title:null,titleId:null,prefix:null,transform:Se,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function rc(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0},n=pp(t),i=n.iconName,r=n.prefix,s=n.rest,o=mp(t),a=fs("parseNodeAttributes",{},t),l=e.styleParser?fp(t):[];return g({iconName:i,title:t.getAttribute("title"),titleId:t.getAttribute("data-fa-title-id"),prefix:r,transform:Se,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:s,styles:l,attributes:o}},a)}var _p=be.styles;function Uc(t){var e=_.autoReplaceSvg==="nest"?rc(t,{styleParser:!1}):rc(t);return~e.extra.classes.indexOf(bc)?We("generateLayersText",t,e):We("generateSvgReplacementMutation",t,e)}var Qe=new Set;Cs.map(function(t){Qe.add("fa-".concat(t))});Object.keys(dn[D]).map(Qe.add.bind(Qe));Object.keys(dn[B]).map(Qe.add.bind(Qe));Qe=_n(Qe);function sc(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!je)return Promise.resolve();var n=M.documentElement.classList,i=function(h){return n.add("".concat(Gl,"-").concat(h))},r=function(h){return n.remove("".concat(Gl,"-").concat(h))},s=_.autoFetchSvg?Qe:Cs.map(function(u){return"fa-".concat(u)}).concat(Object.keys(_p));s.includes("fa")||s.push("fa");var o=[".".concat(bc,":not([").concat(ut,"])")].concat(s.map(function(u){return".".concat(u,":not([").concat(ut,"])")})).join(", ");if(o.length===0)return Promise.resolve();var a=[];try{a=At(t.querySelectorAll(o))}catch{}if(a.length>0)i("pending"),r("complete");else return Promise.resolve();var l=As.begin("onTree"),c=a.reduce(function(u,h){try{var d=Uc(h);d&&u.push(d)}catch(f){yc||f.name==="MissingIcon"&&console.error(f)}return u},[]);return new Promise(function(u,h){Promise.all(c).then(function(d){Lc(d,function(){i("active"),i("complete"),r("pending"),typeof e=="function"&&e(),l(),u()})}).catch(function(d){l(),h(d)})})}function vp(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Uc(t).then(function(n){n&&Lc([n],e)})}function yp(t){return function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=(e||{}).icon?e:ps(e||{}),r=n.mask;return r&&(r=(r||{}).icon?r:ps(r||{})),t(i,g(g({},n),{},{mask:r}))}}var bp=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.transform,r=i===void 0?Se:i,s=n.symbol,o=s===void 0?!1:s,a=n.mask,l=a===void 0?null:a,c=n.maskId,u=c===void 0?null:c,h=n.title,d=h===void 0?null:h,f=n.titleId,p=f===void 0?null:f,v=n.classes,y=v===void 0?[]:v,A=n.attributes,I=A===void 0?{}:A,E=n.styles,N=E===void 0?{}:E;if(e){var z=e.prefix,ne=e.iconName,ve=e.icon;return Gi(g({type:"icon"},e),function(){return ht("beforeDOMElementCreation",{iconDefinition:e,params:n}),_.autoA11y&&(d?I["aria-labelledby"]="".concat(_.replacementClass,"-title-").concat(p||gn()):(I["aria-hidden"]="true",I.focusable="false")),xs({icons:{main:ms(ve),mask:l?ms(l.icon):{found:!1,width:null,height:null,icon:{}}},prefix:z,iconName:ne,transform:g(g({},Se),r),symbol:o,title:d,maskId:u,titleId:p,extra:{attributes:I,styles:N,classes:y}})})}},wp={mixout:function(){return{icon:yp(bp)}},hooks:function(){return{mutationObserverCallbacks:function(n){return n.treeCallback=sc,n.nodeCallback=vp,n}}},provides:function(e){e.i2svg=function(n){var i=n.node,r=i===void 0?M:i,s=n.callback,o=s===void 0?function(){}:s;return sc(r,o)},e.generateSvgReplacementMutation=function(n,i){var r=i.iconName,s=i.title,o=i.titleId,a=i.prefix,l=i.transform,c=i.symbol,u=i.mask,h=i.maskId,d=i.extra;return new Promise(function(f,p){Promise.all([gs(r,a),u.iconName?gs(u.iconName,u.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(v){var y=ys(v,2),A=y[0],I=y[1];f([n,xs({icons:{main:A,mask:I},prefix:a,iconName:r,transform:l,symbol:c,maskId:h,title:s,titleId:o,extra:d,watchable:!0})])}).catch(p)})},e.generateAbstractIcon=function(n){var i=n.children,r=n.attributes,s=n.main,o=n.transform,a=n.styles,l=Hi(a);l.length>0&&(r.style=l);var c;return ks(o)&&(c=We("generateAbstractTransformGrouping",{main:s,transform:o,containerWidth:s.width,iconWidth:s.width})),i.push(c||s.icon),{children:i,attributes:r}}}},Ep={mixout:function(){return{layer:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.classes,s=r===void 0?[]:r;return Gi({type:"layer"},function(){ht("beforeDOMElementCreation",{assembler:n,params:i});var o=[];return n(function(a){Array.isArray(a)?a.map(function(l){o=o.concat(l.abstract)}):o=o.concat(a.abstract)}),[{tag:"span",attributes:{class:["".concat(_.cssPrefix,"-layers")].concat(_n(s)).join(" ")},children:o}]})}}}},Cp={mixout:function(){return{counter:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.title,s=r===void 0?null:r,o=i.classes,a=o===void 0?[]:o,l=i.attributes,c=l===void 0?{}:l,u=i.styles,h=u===void 0?{}:u;return Gi({type:"counter",content:n},function(){return ht("beforeDOMElementCreation",{content:n,params:i}),np({content:n.toString(),title:s,extra:{attributes:c,styles:h,classes:["".concat(_.cssPrefix,"-layers-counter")].concat(_n(a))}})})}}}},Tp={mixout:function(){return{text:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.transform,s=r===void 0?Se:r,o=i.title,a=o===void 0?null:o,l=i.classes,c=l===void 0?[]:l,u=i.attributes,h=u===void 0?{}:u,d=i.styles,f=d===void 0?{}:d;return Gi({type:"text",content:n},function(){return ht("beforeDOMElementCreation",{content:n,params:i}),Zl({content:n,transform:g(g({},Se),s),title:a,extra:{attributes:h,styles:f,classes:["".concat(_.cssPrefix,"-layers-text")].concat(_n(c))}})})}}},provides:function(e){e.generateLayersText=function(n,i){var r=i.title,s=i.transform,o=i.extra,a=null,l=null;if(gc){var c=parseInt(getComputedStyle(n).fontSize,10),u=n.getBoundingClientRect();a=u.width/c,l=u.height/c}return _.autoA11y&&!r&&(o.attributes["aria-hidden"]="true"),Promise.resolve([n,Zl({content:n.innerHTML,width:a,height:l,transform:s,title:r,extra:o,watchable:!0})])}}},kp=new RegExp('"',"ug"),oc=[1105920,1112319];function Ip(t){var e=t.replace(kp,""),n=Wf(e,0),i=n>=oc[0]&&n<=oc[1],r=e.length===2?e[0]===e[1]:!1;return{value:hs(r?e[0]:e),isSecondary:i||r}}function ac(t,e){var n="".concat(mf).concat(e.replace(":","-"));return new Promise(function(i,r){if(t.getAttribute(n)!==null)return i();var s=At(t.children),o=s.filter(function(ve){return ve.getAttribute(us)===e})[0],a=Ye.getComputedStyle(t,e),l=a.getPropertyValue("font-family").match(bf),c=a.getPropertyValue("font-weight"),u=a.getPropertyValue("content");if(o&&!l)return t.removeChild(o),i();if(l&&u!=="none"&&u!==""){var h=a.getPropertyValue("content"),d=~["Sharp"].indexOf(l[2])?B:D,f=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(l[2])?fn[d][l[2].toLowerCase()]:wf[d][c],p=Ip(h),v=p.value,y=p.isSecondary,A=l[0].startsWith("FontAwesome"),I=Ss(f,v),E=I;if(A){var N=Gf(v);N.iconName&&N.prefix&&(I=N.iconName,f=N.prefix)}if(I&&!y&&(!o||o.getAttribute(ws)!==f||o.getAttribute(Es)!==E)){t.setAttribute(n,E),o&&t.removeChild(o);var z=gp(),ne=z.extra;ne.attributes[us]=e,gs(I,f).then(function(ve){var Me=xs(g(g({},z),{},{icons:{main:ve,mask:Rs()},prefix:f,iconName:E,extra:ne,watchable:!0})),de=M.createElementNS("http://www.w3.org/2000/svg","svg");e==="::before"?t.insertBefore(de,t.firstChild):t.appendChild(de),de.outerHTML=Me.map(function(ef){return yn(ef)}).join(`
`),t.removeAttribute(n),i()}).catch(r)}else i()}else i()})}function Sp(t){return Promise.all([ac(t,"::before"),ac(t,"::after")])}function Rp(t){return t.parentNode!==document.head&&!~_f.indexOf(t.tagName.toUpperCase())&&!t.getAttribute(us)&&(!t.parentNode||t.parentNode.tagName!=="svg")}function lc(t){if(je)return new Promise(function(e,n){var i=At(t.querySelectorAll("*")).filter(Rp).map(Sp),r=As.begin("searchPseudoElements");Fc(),Promise.all(i).then(function(){r(),vs(),e()}).catch(function(){r(),vs(),n()})})}var xp={hooks:function(){return{mutationObserverCallbacks:function(n){return n.pseudoElementsCallback=lc,n}}},provides:function(e){e.pseudoElements2svg=function(n){var i=n.node,r=i===void 0?M:i;_.searchPseudoElements&&lc(r)}}},cc=!1,Ap={mixout:function(){return{dom:{unwatch:function(){Fc(),cc=!0}}}},hooks:function(){return{bootstrap:function(){ic(fs("mutationObserverCallbacks",{}))},noAuto:function(){dp()},watch:function(n){var i=n.observeMutationsRoot;cc?vs():ic(fs("mutationObserverCallbacks",{observeMutationsRoot:i}))}}}},uc=function(e){var n={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e.toLowerCase().split(" ").reduce(function(i,r){var s=r.toLowerCase().split("-"),o=s[0],a=s.slice(1).join("-");if(o&&a==="h")return i.flipX=!0,i;if(o&&a==="v")return i.flipY=!0,i;if(a=parseFloat(a),isNaN(a))return i;switch(o){case"grow":i.size=i.size+a;break;case"shrink":i.size=i.size-a;break;case"left":i.x=i.x-a;break;case"right":i.x=i.x+a;break;case"up":i.y=i.y-a;break;case"down":i.y=i.y+a;break;case"rotate":i.rotate=i.rotate+a;break}return i},n)},Np={mixout:function(){return{parse:{transform:function(n){return uc(n)}}}},hooks:function(){return{parseNodeAttributes:function(n,i){var r=i.getAttribute("data-fa-transform");return r&&(n.transform=uc(r)),n}}},provides:function(e){e.generateAbstractTransformGrouping=function(n){var i=n.main,r=n.transform,s=n.containerWidth,o=n.iconWidth,a={transform:"translate(".concat(s/2," 256)")},l="translate(".concat(r.x*32,", ").concat(r.y*32,") "),c="scale(".concat(r.size/16*(r.flipX?-1:1),", ").concat(r.size/16*(r.flipY?-1:1),") "),u="rotate(".concat(r.rotate," 0 0)"),h={transform:"".concat(l," ").concat(c," ").concat(u)},d={transform:"translate(".concat(o/2*-1," -256)")},f={outer:a,inner:h,path:d};return{tag:"g",attributes:g({},f.outer),children:[{tag:"g",attributes:g({},f.inner),children:[{tag:i.icon.tag,children:i.icon.children,attributes:g(g({},i.icon.attributes),f.path)}]}]}}}},as={x:0,y:0,width:"100%",height:"100%"};function hc(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t.attributes&&(t.attributes.fill||e)&&(t.attributes.fill="black"),t}function Pp(t){return t.tag==="g"?t.children:[t]}var Op={hooks:function(){return{parseNodeAttributes:function(n,i){var r=i.getAttribute("data-fa-mask"),s=r?$i(r.split(" ").map(function(o){return o.trim()})):Rs();return s.prefix||(s.prefix=Ke()),n.mask=s,n.maskId=i.getAttribute("data-fa-mask-id"),n}}},provides:function(e){e.generateAbstractMask=function(n){var i=n.children,r=n.attributes,s=n.main,o=n.mask,a=n.maskId,l=n.transform,c=s.width,u=s.icon,h=o.width,d=o.icon,f=Nf({transform:l,containerWidth:h,iconWidth:c}),p={tag:"rect",attributes:g(g({},as),{},{fill:"white"})},v=u.children?{children:u.children.map(hc)}:{},y={tag:"g",attributes:g({},f.inner),children:[hc(g({tag:u.tag,attributes:g(g({},u.attributes),f.path)},v))]},A={tag:"g",attributes:g({},f.outer),children:[y]},I="mask-".concat(a||gn()),E="clip-".concat(a||gn()),N={tag:"mask",attributes:g(g({},as),{},{id:I,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[p,A]},z={tag:"defs",children:[{tag:"clipPath",attributes:{id:E},children:Pp(d)},N]};return i.push(z,{tag:"rect",attributes:g({fill:"currentColor","clip-path":"url(#".concat(E,")"),mask:"url(#".concat(I,")")},as)}),{children:i,attributes:r}}}},Dp={provides:function(e){var n=!1;Ye.matchMedia&&(n=Ye.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var i=[],r={fill:"currentColor"},s={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};i.push({tag:"path",attributes:g(g({},r),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=g(g({},s),{},{attributeName:"opacity"}),a={tag:"circle",attributes:g(g({},r),{},{cx:"256",cy:"364",r:"28"}),children:[]};return n||a.children.push({tag:"animate",attributes:g(g({},s),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:g(g({},o),{},{values:"1;0;1;1;0;1;"})}),i.push(a),i.push({tag:"path",attributes:g(g({},r),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:n?[]:[{tag:"animate",attributes:g(g({},o),{},{values:"1;0;0;0;0;1;"})}]}),n||i.push({tag:"path",attributes:g(g({},r),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:g(g({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:i}}}},Mp={hooks:function(){return{parseNodeAttributes:function(n,i){var r=i.getAttribute("data-fa-symbol"),s=r===null?!1:r===""?!0:r;return n.symbol=s,n}}}},Lp=[Df,wp,Ep,Cp,Tp,xp,Ap,Np,Op,Dp,Mp];Kf(Lp,{mixoutsTo:oe});var Py=oe.noAuto,Oy=oe.config,Dy=oe.library,My=oe.dom,Fp=oe.parse,Ly=oe.findIconDefinition,Fy=oe.toHtml,Up=oe.icon,Uy=oe.layer,Wp=oe.text,jp=oe.counter;var Wc=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=re({type:e}),e.\u0275inj=ie({});let t=e;return t})();var zp=(()=>{let e=class e extends Ri{constructor(i,r,s){super(i,r,s,si(ai,{optional:!0}))}ngOnDestroy(){this.flush()}};e.\u0275fac=function(r){return new(r||e)(S(ci),S(ln),S(Si))},e.\u0275prov=ye({token:e,factory:e.\u0275fac});let t=e;return t})();function Hp(){return new Dl}function Vp(t,e,n){return new Ll(t,e,n)}var Bc=[{provide:Si,useFactory:Hp},{provide:Ri,useClass:zp},{provide:li,useFactory:Vp,deps:[ui,Ri,Ve]}],jc=[{provide:ln,useFactory:()=>new Ml},{provide:sn,useValue:"BrowserAnimations"},...Bc],$p=[{provide:ln,useClass:Ol},{provide:sn,useValue:"NoopAnimations"},...Bc],zc=(()=>{let e=class e{static withConfig(i){return{ngModule:e,providers:i.disableAnimations?$p:jc}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=re({type:e}),e.\u0275inj=ie({providers:jc,imports:[hi]});let t=e;return t})();var Gp="@",qp=(()=>{let e=class e{constructor(i,r,s,o,a){this.doc=i,this.delegate=r,this.zone=s,this.animationType=o,this.moduleImpl=a,this._rendererFactoryPromise=null,this.scheduler=si(ai,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-DB4Y4YOM.js")).catch(r=>{throw new Za(5300,!1)}).then(({\u0275createEngine:r,\u0275AnimationRendererFactory:s})=>{this._engine=r(this.animationType,this.doc,this.scheduler);let o=new s(this.delegate,this._engine,this.zone);return this.delegate=o,o})}createRenderer(i,r){let s=this.delegate.createRenderer(i,r);if(s.\u0275type===0)return s;typeof s.throwOnSyntheticProps=="boolean"&&(s.throwOnSyntheticProps=!1);let o=new Ps(s);return r?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(a=>{let l=a.createRenderer(i,r);o.use(l)}).catch(a=>{o.use(s)}),o}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};e.\u0275fac=function(r){tl()},e.\u0275prov=ye({token:e,factory:e.\u0275fac});let t=e;return t})(),Ps=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let n of this.replay)n(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,n){return this.delegate.createElement(e,n)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,n){this.delegate.appendChild(e,n)}insertBefore(e,n,i,r){this.delegate.insertBefore(e,n,i,r)}removeChild(e,n,i){this.delegate.removeChild(e,n,i)}selectRootElement(e,n){return this.delegate.selectRootElement(e,n)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,n,i,r){this.delegate.setAttribute(e,n,i,r)}removeAttribute(e,n,i){this.delegate.removeAttribute(e,n,i)}addClass(e,n){this.delegate.addClass(e,n)}removeClass(e,n){this.delegate.removeClass(e,n)}setStyle(e,n,i,r){this.delegate.setStyle(e,n,i,r)}removeStyle(e,n,i){this.delegate.removeStyle(e,n,i)}setProperty(e,n,i){this.shouldReplay(n)&&this.replay.push(r=>r.setProperty(e,n,i)),this.delegate.setProperty(e,n,i)}setValue(e,n){this.delegate.setValue(e,n)}listen(e,n,i){return this.shouldReplay(n)&&this.replay.push(r=>r.listen(e,n,i)),this.delegate.listen(e,n,i)}shouldReplay(e){return this.replay!==null&&e.startsWith(Gp)}};function Hc(t="animations"){return Jr("NgAsyncAnimations"),el([{provide:li,useFactory:(e,n,i)=>new qp(e,n,i,t),deps:[ci,ui,Ve]},{provide:sn,useValue:t==="noop"?"NoopAnimations":"BrowserAnimations"}])}var Jc="firebasestorage.googleapis.com",Zc="storageBucket",Xp=2*60*1e3,Jp=10*60*1e3,Zp=1e3;var W=class t extends dl{constructor(e,n,i=0){super(Os(e),`Firebase Storage: ${n} (${Os(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,t.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Os(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},L=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(L||{});function Os(t){return"storage/"+t}function Bs(){let t="An unknown error occurred, please check the error payload for server response.";return new W(L.UNKNOWN,t)}function em(t){return new W(L.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function tm(t){return new W(L.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function nm(){let t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new W(L.UNAUTHENTICATED,t)}function im(){return new W(L.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function rm(t){return new W(L.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function eu(){return new W(L.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function tu(){return new W(L.CANCELED,"User canceled the upload/download.")}function sm(t){return new W(L.INVALID_URL,"Invalid URL '"+t+"'.")}function om(t){return new W(L.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function am(){return new W(L.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Zc+"' property when initializing the app?")}function nu(){return new W(L.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function lm(){return new W(L.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function cm(){return new W(L.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function um(t){return new W(L.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function dt(t){return new W(L.INVALID_ARGUMENT,t)}function iu(){return new W(L.APP_DELETED,"The Firebase app was deleted.")}function zs(t){return new W(L.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function wn(t,e){return new W(L.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function bn(t){throw new W(L.INTERNAL_ERROR,"Internal error: "+t)}var J=class t{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let i;try{i=t.makeFromUrl(e,n)}catch{return new t(e,"")}if(i.path==="")return i;throw om(e)}static makeFromUrl(e,n){let i=null,r="([A-Za-z0-9.\\-_]+)";function s(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),l={bucket:1,path:3};function c(N){N.path_=decodeURIComponent(N.path)}let u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${u}/b/${r}/o${d}`,"i"),p={bucket:1,path:3},v=n===Jc?"(?:storage.googleapis.com|storage.cloud.google.com)":n,y="([^?#]*)",A=new RegExp(`^https?://${v}/${r}/${y}`,"i"),E=[{regex:a,indices:l,postModify:s},{regex:f,indices:p,postModify:c},{regex:A,indices:{bucket:1,path:2},postModify:c}];for(let N=0;N<E.length;N++){let z=E[N],ne=z.regex.exec(e);if(ne){let ve=ne[z.indices.bucket],Me=ne[z.indices.path];Me||(Me=""),i=new t(ve,Me),z.postModify(i);break}}if(i==null)throw sm(e);return i}},Ms=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function hm(t,e,n){let i=1,r=null,s=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...y){c||(c=!0,e.apply(null,y))}function h(y){r=setTimeout(()=>{r=null,t(f,l())},y)}function d(){s&&clearTimeout(s)}function f(y,...A){if(c){d();return}if(y){d(),u.call(null,y,...A);return}if(l()||o){d(),u.call(null,y,...A);return}i<64&&(i*=2);let E;a===1?(a=2,E=0):E=(i+Math.random())*1e3,h(E)}let p=!1;function v(y){p||(p=!0,d(),!c&&(r!==null?(y||(a=2),clearTimeout(r),h(0)):y||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,v(!0)},n),v}function dm(t){t(!1)}function fm(t){return t!==void 0}function pm(t){return typeof t=="function"}function mm(t){return typeof t=="object"&&!Array.isArray(t)}function Ki(t){return typeof t=="string"||t instanceof String}function Vc(t){return Hs()&&t instanceof Blob}function Hs(){return typeof Blob<"u"}function Ls(t,e,n,i){if(i<e)throw dt(`Invalid value for '${t}'. Expected ${e} or greater.`);if(i>n)throw dt(`Invalid value for '${t}'. Expected ${n} or less.`)}function Xe(t,e,n){let i=e;return n==null&&(i=`https://${e}`),`${n}://${i}/v0${t}`}function ru(t){let e=encodeURIComponent,n="?";for(let i in t)if(t.hasOwnProperty(i)){let r=e(i)+"="+e(t[i]);n=n+r+"&"}return n=n.slice(0,-1),n}var Ot=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(Ot||{});function su(t,e){let n=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||r||s}var Fs=class{constructor(e,n,i,r,s,o,a,l,c,u,h,d=!0){this.url_=e,this.method_=n,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((f,p)=>{this.resolve_=f,this.reject_=p,this.start_()})}start_(){let e=(i,r)=>{if(r){i(!1,new Pt(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===Ot.NO_ERROR,l=s.getStatus();if(!a||su(l,this.additionalRetryCodes_)&&this.retry){let u=s.getErrorCode()===Ot.ABORT;i(!1,new Pt(!1,null,u));return}let c=this.successCodes_.indexOf(l)!==-1;i(!0,new Pt(c,s))})},n=(i,r)=>{let s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{let l=this.callback_(a,a.getResponse());fm(l)?s(l):s()}catch(l){o(l)}else if(a!==null){let l=Bs();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(r.canceled){let l=this.appDelete_?iu():tu();o(l)}else{let l=eu();o(l)}};this.canceled_?n(!1,new Pt(!1,null,!0)):this.backoffId_=hm(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&dm(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Pt=class{constructor(e,n,i){this.wasSuccessCode=e,this.connection=n,this.canceled=!!i}};function gm(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function _m(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function vm(t,e){e&&(t["X-Firebase-GMPID"]=e)}function ym(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function bm(t,e,n,i,r,s,o=!0){let a=ru(t.urlParams),l=t.url+a,c=Object.assign({},t.headers);return vm(c,e),gm(c,n),_m(c,s),ym(c,i),new Fs(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,o)}function wm(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Em(...t){let e=wm();if(e!==void 0){let n=new e;for(let i=0;i<t.length;i++)n.append(t[i]);return n.getBlob()}else{if(Hs())return new Blob(t);throw new W(L.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Cm(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}function Tm(t){if(typeof atob>"u")throw um("base-64");return atob(t)}var ae={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},En=class{constructor(e,n){this.data=e,this.contentType=n||null}};function Vs(t,e){switch(t){case ae.RAW:return new En(ou(e));case ae.BASE64:case ae.BASE64URL:return new En(au(t,e));case ae.DATA_URL:return new En(Im(e),Sm(e))}throw Bs()}function ou(t){let e=[];for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{let s=i,o=t.charCodeAt(++n);i=65536|(s&1023)<<10|o&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function km(t){let e;try{e=decodeURIComponent(t)}catch{throw wn(ae.DATA_URL,"Malformed data URL.")}return ou(e)}function au(t,e){switch(t){case ae.BASE64:{let r=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(r||s)throw wn(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case ae.BASE64URL:{let r=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(r||s)throw wn(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=Tm(e)}catch(r){throw r.message.includes("polyfill")?r:wn(t,"Invalid character found")}let i=new Uint8Array(n.length);for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return i}var Yi=class{constructor(e){this.base64=!1,this.contentType=null;let n=e.match(/^data:([^,]+)?,/);if(n===null)throw wn(ae.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let i=n[1]||null;i!=null&&(this.base64=Rm(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}};function Im(t){let e=new Yi(t);return e.base64?au(ae.BASE64,e.rest):km(e.rest)}function Sm(t){return new Yi(t).contentType}function Rm(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}var Dt=class t{constructor(e,n){let i=0,r="";Vc(e)?(this.data_=e,i=e.size,r=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,n){if(Vc(this.data_)){let i=this.data_,r=Cm(i,e,n);return r===null?null:new t(r)}else{let i=new Uint8Array(this.data_.buffer,e,n-e);return new t(i,!0)}}static getBlob(...e){if(Hs()){let n=e.map(i=>i instanceof t?i.data_:i);return new t(Em.apply(null,n))}else{let n=e.map(o=>Ki(o)?Vs(ae.RAW,o).data:o.data_),i=0;n.forEach(o=>{i+=o.byteLength});let r=new Uint8Array(i),s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)r[s++]=o[a]}),new t(r,!0)}}uploadData(){return this.data_}};function $s(t){let e;try{e=JSON.parse(t)}catch{return null}return mm(e)?e:null}function xm(t){if(t.length===0)return null;let e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function Am(t,e){let n=e.split("/").filter(i=>i.length>0).join("/");return t.length===0?n:t+"/"+n}function lu(t){let e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}function Nm(t,e){return e}var Y=class{constructor(e,n,i,r){this.server=e,this.local=n||e,this.writable=!!i,this.xform=r||Nm}},qi=null;function Pm(t){return!Ki(t)||t.length<2?t:lu(t)}function Qi(){if(qi)return qi;let t=[];t.push(new Y("bucket")),t.push(new Y("generation")),t.push(new Y("metageneration")),t.push(new Y("name","fullPath",!0));function e(s,o){return Pm(o)}let n=new Y("name");n.xform=e,t.push(n);function i(s,o){return o!==void 0?Number(o):o}let r=new Y("size");return r.xform=i,t.push(r),t.push(new Y("timeCreated")),t.push(new Y("updated")),t.push(new Y("md5Hash",null,!0)),t.push(new Y("cacheControl",null,!0)),t.push(new Y("contentDisposition",null,!0)),t.push(new Y("contentEncoding",null,!0)),t.push(new Y("contentLanguage",null,!0)),t.push(new Y("contentType",null,!0)),t.push(new Y("metadata","customMetadata",!0)),qi=t,qi}function Om(t,e){function n(){let i=t.bucket,r=t.fullPath,s=new J(i,r);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function Dm(t,e,n){let i={};i.type="file";let r=n.length;for(let s=0;s<r;s++){let o=n[s];i[o.local]=o.xform(i,e[o.server])}return Om(i,t),i}function cu(t,e,n){let i=$s(e);return i===null?null:Dm(t,i,n)}function Mm(t,e,n,i){let r=$s(e);if(r===null||!Ki(r.downloadTokens))return null;let s=r.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(c=>{let u=t.bucket,h=t.fullPath,d="/b/"+o(u)+"/o/"+o(h),f=Xe(d,n,i),p=ru({alt:"media",token:c});return f+p})[0]}function Gs(t,e){let n={},i=e.length;for(let r=0;r<i;r++){let s=e[r];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}var $c="prefixes",Gc="items";function Lm(t,e,n){let i={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[$c])for(let r of n[$c]){let s=r.replace(/\/$/,""),o=t._makeStorageReference(new J(e,s));i.prefixes.push(o)}if(n[Gc])for(let r of n[Gc]){let s=t._makeStorageReference(new J(e,r.name));i.items.push(s)}return i}function Fm(t,e,n){let i=$s(n);return i===null?null:Lm(t,e,i)}var we=class{constructor(e,n,i,r){this.url=e,this.method=n,this.handler=i,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function xe(t){if(!t)throw Bs()}function Xi(t,e){function n(i,r){let s=cu(t,r,e);return xe(s!==null),s}return n}function Um(t,e){function n(i,r){let s=Fm(t,e,r);return xe(s!==null),s}return n}function Wm(t,e){function n(i,r){let s=cu(t,r,e);return xe(s!==null),Mm(s,r,t.host,t._protocol)}return n}function Ft(t){function e(n,i){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=im():r=nm():n.getStatus()===402?r=tm(t.bucket):n.getStatus()===403?r=rm(t.path):r=i,r.status=n.getStatus(),r.serverResponse=i.serverResponse,r}return e}function Ji(t){let e=Ft(t);function n(i,r){let s=e(i,r);return i.getStatus()===404&&(s=em(t.path)),s.serverResponse=r.serverResponse,s}return n}function uu(t,e,n){let i=e.fullServerUrl(),r=Xe(i,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new we(r,s,Xi(t,n),o);return a.errorHandler=Ji(e),a}function jm(t,e,n,i,r){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",n&&n.length>0&&(s.delimiter=n),i&&(s.pageToken=i),r&&(s.maxResults=r);let o=e.bucketOnlyServerUrl(),a=Xe(o,t.host,t._protocol),l="GET",c=t.maxOperationRetryTime,u=new we(a,l,Um(t,e.bucket),c);return u.urlParams=s,u.errorHandler=Ft(e),u}function Bm(t,e,n){let i=e.fullServerUrl(),r=Xe(i,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new we(r,s,Wm(t,n),o);return a.errorHandler=Ji(e),a}function zm(t,e,n,i){let r=e.fullServerUrl(),s=Xe(r,t.host,t._protocol),o="PATCH",a=Gs(n,i),l={"Content-Type":"application/json; charset=utf-8"},c=t.maxOperationRetryTime,u=new we(s,o,Xi(t,i),c);return u.headers=l,u.body=a,u.errorHandler=Ji(e),u}function Hm(t,e){let n=e.fullServerUrl(),i=Xe(n,t.host,t._protocol),r="DELETE",s=t.maxOperationRetryTime;function o(l,c){}let a=new we(i,r,o,s);return a.successCodes=[200,204],a.errorHandler=Ji(e),a}function Vm(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function hu(t,e,n){let i=Object.assign({},n);return i.fullPath=t.path,i.size=e.size(),i.contentType||(i.contentType=Vm(null,e)),i}function $m(t,e,n,i,r){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let E="";for(let N=0;N<2;N++)E=E+Math.random().toString().slice(2);return E}let l=a();o["Content-Type"]="multipart/related; boundary="+l;let c=hu(e,i,r),u=Gs(c,n),h="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,d=`\r
--`+l+"--",f=Dt.getBlob(h,i,d);if(f===null)throw nu();let p={name:c.fullPath},v=Xe(s,t.host,t._protocol),y="POST",A=t.maxUploadRetryTime,I=new we(v,y,Xi(t,n),A);return I.urlParams=p,I.headers=o,I.body=f.uploadData(),I.errorHandler=Ft(e),I}var Mt=class{constructor(e,n,i,r){this.current=e,this.total=n,this.finalized=!!i,this.metadata=r||null}};function qs(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{xe(!1)}return xe(!!n&&(e||["active"]).indexOf(n)!==-1),n}function Gm(t,e,n,i,r){let s=e.bucketOnlyServerUrl(),o=hu(e,i,r),a={name:o.fullPath},l=Xe(s,t.host,t._protocol),c="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${i.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=Gs(o,n),d=t.maxUploadRetryTime;function f(v){qs(v);let y;try{y=v.getResponseHeader("X-Goog-Upload-URL")}catch{xe(!1)}return xe(Ki(y)),y}let p=new we(l,c,f,d);return p.urlParams=a,p.headers=u,p.body=h,p.errorHandler=Ft(e),p}function qm(t,e,n,i){let r={"X-Goog-Upload-Command":"query"};function s(c){let u=qs(c,["active","final"]),h=null;try{h=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{xe(!1)}h||xe(!1);let d=Number(h);return xe(!isNaN(d)),new Mt(d,i.size(),u==="final")}let o="POST",a=t.maxUploadRetryTime,l=new we(n,o,s,a);return l.headers=r,l.errorHandler=Ft(e),l}var qc=256*1024;function Ym(t,e,n,i,r,s,o,a){let l=new Mt(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=i.size()),i.size()!==l.total)throw lm();let c=l.total-l.current,u=c;r>0&&(u=Math.min(u,r));let h=l.current,d=h+u,f="";u===0?f="finalize":c===u?f="upload, finalize":f="upload";let p={"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":`${l.current}`},v=i.slice(h,d);if(v===null)throw nu();function y(N,z){let ne=qs(N,["active","final"]),ve=l.current+u,Me=i.size(),de;return ne==="final"?de=Xi(e,s)(N,z):de=null,new Mt(ve,Me,ne==="final",de)}let A="POST",I=e.maxUploadRetryTime,E=new we(n,A,y,I);return E.headers=p,E.body=v.uploadData(),E.progressCallback=a||null,E.errorHandler=Ft(t),E}var du={STATE_CHANGED:"state_changed"},K={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Ds(t){switch(t){case"running":case"pausing":case"canceling":return K.RUNNING;case"paused":return K.PAUSED;case"success":return K.SUCCESS;case"canceled":return K.CANCELED;case"error":return K.ERROR;default:return K.ERROR}}var Us=class{constructor(e,n,i){if(pm(e)||n!=null||i!=null)this.next=e,this.error=n??void 0,this.complete=i??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function Nt(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}var Yc=null,Ws=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ot.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ot.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ot.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,i,r){if(this.sent_)throw bn("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),r!==void 0)for(let s in r)r.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,r[s].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw bn("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw bn("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw bn("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw bn("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},js=class extends Ws{initXhr(){this.xhr_.responseType="text"}};function Re(){return Yc?Yc():new js}var Cn=class{constructor(e,n,i=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=i,this._mappings=Qi(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=r=>{if(this._request=void 0,this._chunkMultiplier=1,r._codeEquals(L.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(su(r.status,[]))if(s)r=eu();else{this.sleepTime=Math.max(this.sleepTime*2,Zp),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=r,this._transition("error")}},this._metadataErrorHandler=r=>{this._request=void 0,r._codeEquals(L.CANCELED)?this.completeTransitions_():(this._error=r,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((r,s)=>{this._resolve=r,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,i])=>{switch(this._state){case"running":e(n,i);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{let i=Gm(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(i,Re,e,n);this._request=r,r.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((n,i)=>{let r=qm(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(r,Re,n,i);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=qc*this._chunkMultiplier,n=new Mt(this._transferred,this._blob.size()),i=this._uploadUrl;this._resolveToken((r,s)=>{let o;try{o=Ym(this._ref._location,this._ref.storage,i,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}let a=this._ref.storage._makeRequest(o,Re,r,s,!1);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){qc*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{let i=uu(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(i,Re,e,n);this._request=r,r.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{let i=$m(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(i,Re,e,n);this._request=r,r.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=tu(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=Ds(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,i,r){let s=new Us(n||void 0,i||void 0,r||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Ds(this._state)){case K.SUCCESS:Nt(this._resolve.bind(null,this.snapshot))();break;case K.CANCELED:case K.ERROR:let n=this._reject;Nt(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Ds(this._state)){case K.RUNNING:case K.PAUSED:e.next&&Nt(e.next.bind(e,this.snapshot))();break;case K.SUCCESS:e.complete&&Nt(e.complete.bind(e))();break;case K.CANCELED:case K.ERROR:e.error&&Nt(e.error.bind(e,this._error))();break;default:e.error&&Nt(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var Lt=class t{constructor(e,n){this._service=e,n instanceof J?this._location=n:this._location=J.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new t(e,n)}get root(){let e=new J(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return lu(this._location.path)}get storage(){return this._service}get parent(){let e=xm(this._location.path);if(e===null)return null;let n=new J(this._location.bucket,e);return new t(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw zs(e)}};function Km(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new Cn(t,new Dt(e),n)}function Qm(t){let e={prefixes:[],items:[]};return fu(t,e).then(()=>e)}function fu(t,e,n){return at(this,null,function*(){let r=yield pu(t,{pageToken:n});e.prefixes.push(...r.prefixes),e.items.push(...r.items),r.nextPageToken!=null&&(yield fu(t,e,r.nextPageToken))})}function pu(t,e){e!=null&&typeof e.maxResults=="number"&&Ls("options.maxResults",1,1e3,e.maxResults);let n=e||{},i=jm(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(i,Re)}function Xm(t){t._throwIfRoot("getMetadata");let e=uu(t.storage,t._location,Qi());return t.storage.makeRequestWithTokens(e,Re)}function Jm(t,e){t._throwIfRoot("updateMetadata");let n=zm(t.storage,t._location,e,Qi());return t.storage.makeRequestWithTokens(n,Re)}function Zm(t){t._throwIfRoot("getDownloadURL");let e=Bm(t.storage,t._location,Qi());return t.storage.makeRequestWithTokens(e,Re).then(n=>{if(n===null)throw cm();return n})}function eg(t){t._throwIfRoot("deleteObject");let e=Hm(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Re)}function mu(t,e){let n=Am(t._location.path,e),i=new J(t._location.bucket,n);return new Lt(t.storage,i)}function tg(t){return/^[A-Za-z]+:\/\//.test(t)}function ng(t,e){return new Lt(t,e)}function gu(t,e){if(t instanceof Tn){let n=t;if(n._bucket==null)throw am();let i=new Lt(n,n._bucket);return e!=null?gu(i,e):i}else return e!==void 0?mu(t,e):t}function ig(t,e){if(e&&tg(e)){if(t instanceof Tn)return ng(t,e);throw dt("To use ref(service, url), the first argument must be a Storage instance.")}else return gu(t,e)}function Kc(t,e){let n=e?.[Zc];return n==null?null:J.makeFromBucketSpec(n,t)}function rg(t,e,n,i={}){t.host=`${e}:${n}`,t._protocol="http";let{mockUserToken:r}=i;r&&(t._overrideAuthToken=typeof r=="string"?r:di(r,t.app.options.projectId))}var Tn=class{constructor(e,n,i,r,s){this.app=e,this._authProvider=n,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=Jc,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Xp,this._maxUploadRetryTime=Jp,this._requests=new Set,r!=null?this._bucket=J.makeFromBucketSpec(r,this._host):this._bucket=Kc(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=J.makeFromBucketSpec(this._url,e):this._bucket=Kc(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ls("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ls("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return at(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let n=yield e.getToken();if(n!==null)return n.accessToken}return null})}_getAppCheckToken(){return at(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Lt(this,e)}_makeRequest(e,n,i,r,s=!0){if(this._deleted)return new Ms(iu());{let o=bm(e,this._appId,i,r,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,n){return at(this,null,function*(){let[i,r]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,i,r).getPromise()})}},Qc="@firebase/storage",Xc="0.12.2";var sg="storage";function _u(t,e,n){return t=U(t),Km(t,e,n)}function vu(t){return t=U(t),Xm(t)}function yu(t,e){return t=U(t),Jm(t,e)}function bu(t,e){return t=U(t),pu(t,e)}function wu(t){return t=U(t),Qm(t)}function Eu(t){return t=U(t),Zm(t)}function Cu(t){return t=U(t),eg(t)}function Ys(t,e){return t=U(t),ig(t,e)}function Tu(t,e){return mu(t,e)}function ku(t,e,n,i={}){rg(t,e,n,i)}function og(t,{instanceIdentifier:e}){let n=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new Tn(n,i,r,e,vi)}function ag(){_i(new ke(sg,og,"PUBLIC").setMultipleInstances(!0)),kt(Qc,Xc,""),kt(Qc,Xc,"esm2017")}ag();var Ut=class{constructor(e,n,i){this._delegate=e,this.task=n,this.ref=i}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var Zi=class{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Ut(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(i=>{if(e)return e(new Ut(i,this,this._ref))},n)}on(e,n,i,r){let s;return n&&(typeof n=="function"?s=o=>n(new Ut(o,this,this._ref)):s={next:n.next?o=>n.next(new Ut(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,s,i||void 0,r||void 0)}},er=class{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new ft(e,this._service))}get items(){return this._delegate.items.map(e=>new ft(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var ft=class t{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let n=Tu(this._delegate,e);return new t(n,this.storage)}get root(){return new t(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new t(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new Zi(_u(this._delegate,e,n),this)}putString(e,n=ae.RAW,i){this._throwIfRoot("putString");let r=Vs(n,e),s=Object.assign({},i);return s.contentType==null&&r.contentType!=null&&(s.contentType=r.contentType),new Zi(new Cn(this._delegate,new Dt(r.data,!0),s),this)}listAll(){return wu(this._delegate).then(e=>new er(e,this.storage))}list(e){return bu(this._delegate,e||void 0).then(n=>new er(n,this.storage))}getMetadata(){return vu(this._delegate)}updateMetadata(e){return yu(this._delegate,e)}getDownloadURL(){return Eu(this._delegate)}delete(){return this._throwIfRoot("delete"),Cu(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw zs(e)}};var tr=class{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(Iu(e))throw dt("ref() expected a child path but got a URL, use refFromURL instead.");return new ft(Ys(this._delegate,e),this)}refFromURL(e){if(!Iu(e))throw dt("refFromURL() expected a full URL but got a child path, use ref() instead.");try{J.makeFromUrl(e,this._delegate.host)}catch{throw dt("refFromUrl() expected a valid full URL but got an invalid one.")}return new ft(Ys(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,i={}){ku(this._delegate,e,n,i)}};function Iu(t){return/^[A-Za-z]+:\/\//.test(t)}var lg="@firebase/storage-compat",cg="0.3.5";var ug="storage-compat";function hg(t,{instanceIdentifier:e}){let n=t.getProvider("app-compat").getImmediate(),i=t.getProvider("storage").getImmediate({identifier:e});return new tr(n,i)}function dg(t){let e={TaskState:K,TaskEvent:du,StringFormat:ae,Storage:tr,Reference:ft};t.INTERNAL.registerComponent(new ke(ug,hg,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(lg,cg)}dg(Le);function mg(t){return new ri(e=>{let n=o=>e.next(o),i=o=>e.error(o),r=()=>e.complete();n(t.snapshot);let s=t.on("state_changed",n);return t.then(o=>{n(o),r()},o=>{n(t.snapshot),i(o)}),function(){s()}}).pipe(qa(0))}function Su(t){let e=mg(t);return{task:t,then:t.then.bind(t),catch:t.catch.bind(t),pause:t.pause.bind(t),cancel:t.cancel.bind(t),resume:t.resume.bind(t),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(fe(n=>n.bytesTransferred/n.totalBytes*100))}}function nr(t){return{getDownloadURL:()=>rn(void 0).pipe(is,Ct(()=>t.getDownloadURL()),Ie),getMetadata:()=>rn(void 0).pipe(is,Ct(()=>t.getMetadata()),Ie),delete:()=>nn(t.delete()),child:e=>nr(t.child(e)),updateMetadata:e=>nn(t.updateMetadata(e)),put:(e,n)=>{let i=t.put(e,n);return Su(i)},putString:(e,n,i)=>{let r=t.putString(e,n,i);return Su(r)},list:e=>nn(t.list(e)),listAll:()=>nn(t.listAll())}}var gg=new He("angularfire2.storageBucket"),_g=new He("angularfire2.storage.maxUploadRetryTime"),vg=new He("angularfire2.storage.maxOperationRetryTime"),yg=new He("angularfire2.storage.use-emulator"),bg=(()=>{class t{storage;constructor(n,i,r,s,o,a,l,c,u,h){let d=Ti(n,o,i);this.storage=ki(`${d.name}.storage.${r}`,"AngularFireStorage",d.name,()=>{let f=o.runOutsideAngular(()=>d.storage(r||void 0)),p=u;return p&&f.useEmulator(...p),l&&f.setMaxUploadRetryTime(l),c&&f.setMaxOperationRetryTime(c),f},[l,c])}ref(n){return nr(this.storage.ref(n))}refFromURL(n){return nr(this.storage.refFromURL(n))}upload(n,i,r){let s=this.storage.ref(n);return nr(s).put(i,r)}static \u0275fac=function(i){return new(i||t)(S(Ei),S(Ci,8),S(gg,8),S(oi),S(Ve),S(wi),S(_g,8),S(vg,8),S(yg,8),S(bi,8))};static \u0275prov=ye({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var wg=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=re({type:t});static \u0275inj=ie({})}return t})(),Ru=(()=>{class t{constructor(){Le.registerVersion("angularfire",yi.full,"gcs-compat")}static \u0275fac=function(i){return new(i||t)};static \u0275mod=re({type:t});static \u0275inj=ie({providers:[bg],imports:[wg]})}return t})();var xu="@firebase/database",Au="1.0.3";var aa="";function la(t){aa=t}var no=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),H(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:fi(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var io=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return pe(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var ah=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new no(e)}}catch{}return new io},mt=ah("localStorage"),ro=ah("sessionStorage");var zt=new gi("@firebase/database"),lh=function(){let t=1;return function(){return t++}}(),ch=function(t){let e=_l(t),n=new gl;n.update(e);let i=n.digest();return ll.encodeByteArray(i)},Yn=function(...t){let e="";for(let n=0;n<t.length;n++){let i=t[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=Yn.apply(null,i):typeof i=="object"?e+=H(i):e+=i,e+=" "}return e},gt=null,Nu=!0,uh=function(t,e){m(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(zt.logLevel=vl.VERBOSE,gt=zt.log.bind(zt),e&&ro.set("logging_enabled",!0)):typeof t=="function"?gt=t:(gt=null,ro.remove("logging_enabled"))},G=function(...t){if(Nu===!0&&(Nu=!1,gt===null&&ro.get("logging_enabled")===!0&&uh(!0)),gt){let e=Yn.apply(null,t);gt(e)}},Kn=function(t){return function(...e){G(t,...e)}},so=function(...t){let e="FIREBASE INTERNAL ERROR: "+Yn(...t);zt.error(e)},Pe=function(...t){let e=`FIREBASE FATAL ERROR: ${Yn(...t)}`;throw zt.error(e),new Error(e)},Q=function(...t){let e="FIREBASE WARNING: "+Yn(...t);zt.warn(e)},Eg=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Q("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Ar=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},Cg=function(t){if(Te()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},tt="[MIN_NAME]",Be="[MAX_NAME]",vt=function(t,e){if(t===e)return 0;if(t===tt||e===Be)return-1;if(e===tt||t===Be)return 1;{let n=Pu(t),i=Pu(e);return n!==null?i!==null?n-i===0?t.length-e.length:n-i:-1:i!==null?1:t<e?-1:1}},Tg=function(t,e){return t===e?0:t<e?-1:1},kn=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+H(e))},ca=function(t){if(typeof t!="object"||t===null)return H(t);let e=[];for(let i in t)e.push(i);e.sort();let n="{";for(let i=0;i<e.length;i++)i!==0&&(n+=","),n+=H(e[i]),n+=":",n+=ca(t[e[i]]);return n+="}",n},hh=function(t,e){let n=t.length;if(n<=e)return[t];let i=[];for(let r=0;r<n;r+=e)r+e>n?i.push(t.substring(r,n)):i.push(t.substring(r,r+e));return i};function q(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var dh=function(t){m(!Ar(t),"Invalid JSON number");let e=11,n=52,i=(1<<e-1)-1,r,s,o,a,l;t===0?(s=0,o=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),i),s=a+i,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-i-n))));let c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(r?1:0),c.reverse();let u=c.join(""),h="";for(l=0;l<64;l+=8){let d=parseInt(u.substr(l,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},kg=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Ig=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Sg(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let i=new Error(t+" at "+e._path.toString()+": "+n);return i.code=t.toUpperCase(),i}var Rg=new RegExp("^-?(0*)\\d{1,10}$"),xg=-2147483648,Ag=2147483647,Pu=function(t){if(Rg.test(t)){let e=Number(t);if(e>=xg&&e<=Ag)return e}return null},Xt=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Q("Exception was thrown by user callback.",n),e},Math.floor(0))}},Ng=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},xn=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var oo=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){Q(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var ao=class{constructor(e,n,i){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(G("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Q(e)}},An=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),rr="5",fh="v",ph="s",mh="r",gh="f",_h=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,vh="ls",yh="p",lo="ac",bh="websocket",wh="long_polling";var sr=class{constructor(e,n,i,r,s=!1,o="",a=!1,l=!1){this.secure=n,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=mt.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&mt.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function Pg(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function Eh(t,e,n){m(typeof e=="string","typeof type must == string"),m(typeof n=="object","typeof params must == object");let i;if(e===bh)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===wh)i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Pg(t)&&(n.ns=t.namespace);let r=[];return q(n,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}var co=class{constructor(){this.counters_={}}incrementCounter(e,n=1){pe(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return ul(this.counters_)}};var Ks={},Qs={};function ua(t){let e=t.toString();return Ks[e]||(Ks[e]=new co),Ks[e]}function Og(t,e){let n=t.toString();return Qs[n]||(Qs[n]=e()),Qs[n]}var uo=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&Xt(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var Ou="start",Dg="close",Mg="pLPCommand",Lg="pRTLPCB",Ch="id",Th="pw",kh="ser",Fg="cb",Ug="seg",Wg="ts",jg="d",Bg="dframe",Ih=1870,Sh=30,zg=Ih-Sh,Hg=25e3,Vg=3e4,Dn=class t{constructor(e,n,i,r,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Kn(e),this.stats_=ua(n),this.urlFn=l=>(this.appCheckToken&&(l[lo]=this.appCheckToken),Eh(n,wh,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new uo(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Vg)),Cg(()=>{if(this.isClosed_)return;this.scriptTagHolder=new ho((...s)=>{let[o,a,l,c,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===Ou)this.id=a,this.password=l;else if(o===Dg)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let i={};i[Ou]="t",i[kh]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[Fg]=this.scriptTagHolder.uniqueCallbackIdentifier),i[fh]=rr,this.transportSessionId&&(i[ph]=this.transportSessionId),this.lastSessionId&&(i[vh]=this.lastSessionId),this.applicationId&&(i[yh]=this.applicationId),this.appCheckToken&&(i[lo]=this.appCheckToken),typeof location<"u"&&location.hostname&&_h.test(location.hostname)&&(i[mh]=gh);let r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return Te()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!kg()&&!Ig()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=H(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let i=cl(n),r=hh(i,zg);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(Te())return;this.myDisconnFrame=document.createElement("iframe");let i={};i[Bg]="t",i[Ch]=e,i[Th]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=H(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},ho=class t{constructor(e,n,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Te())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=lh(),window[Mg+this.uniqueCallbackIdentifier]=e,window[Lg+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){G("frame writing exception"),a.stack&&G(a.stack),G(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||G("No IE domain setting required")}catch{let i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[Ch]=this.myID,e[Th]=this.myPW,e[kh]=this.currentSerial;let n=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Sh+i.length<=Ih;){let o=this.pendingSegs.shift();i=i+"&"+Ug+r+"="+o.seg+"&"+Wg+r+"="+o.ts+"&"+jg+r+"="+o.d,r++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,i){this.pendingSegs.push({seg:e,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(i,Math.floor(Hg)),s=()=>{clearTimeout(r),i()};this.addTag(e,s)}addTag(e,n){Te()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){let r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{G("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}};var $g=16384,Gg=45e3,or=null;typeof MozWebSocket<"u"?or=MozWebSocket:typeof WebSocket<"u"&&(or=WebSocket);var jt=(()=>{class t{constructor(n,i,r,s,o,a,l){this.connId=n,this.applicationId=r,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Kn(this.connId),this.stats_=ua(i),this.connURL=t.connectionURL_(i,a,l,s,r),this.nodeAdmin=i.nodeAdmin}static connectionURL_(n,i,r,s,o){let a={};return a[fh]=rr,!Te()&&typeof location<"u"&&location.hostname&&_h.test(location.hostname)&&(a[mh]=gh),i&&(a[ph]=i),r&&(a[vh]=r),s&&(a[lo]=s),o&&(a[yh]=o),Eh(n,bh,a)}open(n,i){this.onDisconnect=i,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,mt.set("previous_websocket_failure",!0);try{let r;if(Te()){let s=this.nodeAdmin?"AdminNode":"Node";r={headers:{"User-Agent":`Firebase/${rr}/${aa}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(r.proxy={origin:a})}this.mySock=new or(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");let s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let i=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(i);r&&r.length>1&&parseFloat(r[1])<4.4&&(n=!0)}return!n&&or!==null&&!t.forceDisallow_}static previouslyFailed(){return mt.isInMemoryStorage||mt.get("previous_websocket_failure")===!0}markConnectionHealthy(){mt.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let i=this.frames.join("");this.frames=null;let r=fi(i);this.onMessage(r)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(m(this.frames===null,"We already have a frame buffer"),n.length<=6){let i=Number(n);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let i=n.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(i);else{let r=this.extractFrameCount_(i);r!==null&&this.appendFrame_(r)}}send(n){this.resetKeepAlive();let i=H(n);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);let r=hh(i,$g);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Gg))}sendString_(n){try{this.mySock.send(n)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),Rh=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Dn,jt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let i=jt&&jt.isAvailable(),r=i&&!jt.previouslyFailed();if(n.webSocketOnly&&(i||Q("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[jt];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),qg=6e4,Yg=5e3,Kg=10*1024,Qg=100*1024,Xs="t",Du="d",Xg="s",Mu="r",Jg="e",Lu="o",Fu="a",Uu="n",Wu="p",Zg="h",fo=class{constructor(e,n,i,r,s,o,a,l,c,u){this.id=e,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Kn("c:"+this.id+":"),this.transportManager_=new Rh(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));let r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=xn(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Qg?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Kg?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Xs in e){let n=e[Xs];n===Fu?this.upgradeIfSecondaryHealthy_():n===Mu?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Lu&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=kn("t",e),i=kn("d",e);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Wu,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Fu,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Uu,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=kn("t",e),i=kn("d",e);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=kn(Xs,e);if(Du in e){let i=e[Du];if(n===Zg){let r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(n===Uu){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===Xg?this.onConnectionShutdown_(i):n===Mu?this.onReset_(i):n===Jg?so("Server Error: "+i):n===Lu?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):so("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),rr!==i&&Q("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),xn(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(qg))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):xn(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Yg))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Wu,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(mt.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var ar=class{put(e,n,i,r){}merge(e,n,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,i){}onDisconnectMerge(e,n,i){}onDisconnectCancel(e,n){}reportStats(e){}};var lr=class{constructor(e){this.allowedEvents_=e,this.listeners_={},m(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,n)}}on(e,n,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:i});let r=this.getInitialEvent(e);r&&n.apply(i,r)}off(e,n,i){this.validateEventType_(e);let r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===n&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(e){m(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var cr=class t extends lr{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!es()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return m(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var ju=32,Bu=768,x=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function R(){return new x("")}function C(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function nt(t){return t.pieces_.length-t.pieceNum_}function P(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new x(t.pieces_,e)}function ha(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function e_(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Mn(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function xh(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new x(e,0)}function F(t,e){let n=[];for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof x)for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{let i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new x(n,0)}function T(t){return t.pieceNum_>=t.pieces_.length}function Z(t,e){let n=C(t),i=C(e);if(n===null)return e;if(n===i)return Z(P(t),P(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function t_(t,e){let n=Mn(t,0),i=Mn(e,0);for(let r=0;r<n.length&&r<i.length;r++){let s=vt(n[r],i[r]);if(s!==0)return s}return n.length===i.length?0:n.length<i.length?-1:1}function da(t,e){if(nt(t)!==nt(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function me(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(nt(t)>nt(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}var po=class{constructor(e,n){this.errorPrefix_=n,this.parts_=Mn(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=an(this.parts_[i]);Ah(this)}};function n_(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=an(e),Ah(t)}function i_(t){let e=t.parts_.pop();t.byteLength_-=an(e),t.parts_.length>0&&(t.byteLength_-=1)}function Ah(t){if(t.byteLength_>Bu)throw new Error(t.errorPrefix_+"has a key path longer than "+Bu+" bytes ("+t.byteLength_+").");if(t.parts_.length>ju)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ju+") or object contains a cycle "+pt(t))}function pt(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var mo=class t extends lr{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new t}getInitialEvent(e){return m(e==="visible","Unknown event type: "+e),[this.visible_]}};var In=1e3,r_=60*5*1e3,zu=30*1e3,s_=1.3,o_=3e4,a_="server_kill",Hu=3,fa=(()=>{class t extends ar{constructor(n,i,r,s,o,a,l,c){if(super(),this.repoInfo_=n,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=Kn("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=In,this.maxReconnectDelay_=r_,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!Te())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");mo.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&cr.getInstance().on("online",this.onOnline_,this)}sendRequest(n,i,r){let s=++this.requestNumber_,o={r:s,a:n,b:i};this.log_(H(o)),m(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),r&&(this.requestCBHash_[s]=r)}get(n){this.initConnection_();let i=new X,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let l=a.d;a.s==="ok"?i.resolve(l):i.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),i.promise}listen(n,i,r,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),m(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),m(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let l={onComplete:s,hashFn:i,query:n,tag:r};this.listens.get(a).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(n){let i=this.outstandingGets_[n];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(n){let i=n.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);let o={p:r},a="q";n.tag&&(o.q=i._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,l=>{let c=l.d,u=l.s;t.warnOnListenWarnings_(c,i),(this.listens.get(r)&&this.listens.get(r).get(s))===n&&(this.log_("listen response",l),u!=="ok"&&this.removeListen_(r,s),n.onComplete&&n.onComplete(u,c))})}static warnOnListenWarnings_(n,i){if(n&&typeof n=="object"&&pe(n,"w")){let r=$e(n,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){let s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',o=i._path.toString();Q(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||pl(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=zu)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,i=fl(n)?"auth":"gauth",r={cred:n};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let i=n.s,r=n.d||"error";i==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(n,i){let r=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),m(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,n._queryObject,i)}sendUnlisten_(n,i,r,s){this.log_("Unlisten on "+n+" for "+i);let o={p:n},a="n";s&&(o.q=r,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,i,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:i,onComplete:r})}onDisconnectMerge(n,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,i,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:i,onComplete:r})}onDisconnectCancel(n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(n,i,r,s){let o={p:i,d:r};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,i,r,s){this.putInternal("p",n,i,r,s)}merge(n,i,r,s){this.putInternal("m",n,i,r,s)}putInternal(n,i,r,s,o){this.initConnection_();let a={p:i,d:r};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+i)}sendPut_(n){let i=this.outstandingPuts_[n].action,r=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(i,r,o=>{this.log_(i+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let i={c:n};this.log_("reportStats",i),this.sendRequest("s",i,r=>{if(r.s!=="ok"){let o=r.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+H(n));let i=n.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,i){this.log_("handleServerMessage",n,i),n==="d"?this.onDataUpdate_(i.p,i.d,!1,i.t):n==="m"?this.onDataUpdate_(i.p,i.d,!0,i.t):n==="c"?this.onListenRevoked_(i.p,i.q):n==="ac"?this.onAuthRevoked_(i.s,i.d):n==="apc"?this.onAppCheckRevoked_(i.s,i.d):n==="sd"?this.onSecurityDebugPacket_(i):so("Unrecognized action received from server: "+H(n)+`
Are you using the latest client?`)}onReady_(n,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){m(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=In,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=In,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>o_&&(this.reconnectDelay_=In),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,i=Math.max(0,this.reconnectDelay_-n);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*s_)}this.onConnectStatus_(!1)}establishConnection_(){return at(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),i=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,l=null,c=function(){l?l.close():(a=!0,r())},u=function(d){m(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(d)};this.realtime_={close:c,sendRequest:u};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[d,f]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?G("getToken() completed but was canceled"):(G("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=f&&f.token,l=new fo(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,i,r,p=>{Q(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(a_)},o))}catch(d){this.log_("Failed to get token: "+d),a||(this.repoInfo_.nodeAdmin&&Q(d),c())}}})}interrupt(n){G("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){G("Resuming connection for reason: "+n),delete this.interruptReasons_[n],pi(this.interruptReasons_)&&(this.reconnectDelay_=In,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let i=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let i=this.outstandingPuts_[n];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,i){let r;i?r=i.map(o=>ca(o)).join("$"):r="default";let s=this.removeListen_(n,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,i){let r=new x(n).toString(),s;if(this.listens.has(r)){let o=this.listens.get(r);s=o.get(i),o.delete(i),o.size===0&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(n,i){G("Auth token revoked: "+n+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Hu&&(this.reconnectDelay_=zu,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,i){G("App check token revoked: "+n+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Hu&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let i of n.values())this.sendListen_(i);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},i="js";Te()&&(this.repoInfo_.nodeAdmin?i="admin_node":i="node"),n["sdk."+i+"."+aa.replace(/\./g,"-")]=1,es()?n["framework.cordova"]=1:hl()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=cr.getInstance().currentlyOnline();return pi(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),k=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Ht=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let i=new k(tt,e),r=new k(tt,n);return this.compare(i,r)!==0}minPost(){return k.MIN}};var ir,ur=class extends Ht{static get __EMPTY_NODE(){return ir}static set __EMPTY_NODE(e){ir=e}compare(e,n){return vt(e.name,n.name)}isDefinedOn(e){throw Tt("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return k.MIN}maxPost(){return new k(Be,ir)}makePost(e,n){return m(typeof e=="string","KeyIndex indexValue must always be a string."),new k(e,ir)}toString(){return".key"}},Ne=new ur;var Bt=class{constructor(e,n,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?i(e.key,n):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Ee=(()=>{class t{constructor(n,i,r,s,o){this.key=n,this.value=i,this.color=r??t.RED,this.left=s??ge.EMPTY_NODE,this.right=o??ge.EMPTY_NODE}copy(n,i,r,s,o){return new t(n??this.key,i??this.value,r??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,i,r){let s=this,o=r(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,i,r),null):o===0?s=s.copy(null,i,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return ge.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,i){let r,s;if(r=this,i(n,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(n,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),i(n,r.key)===0){if(r.right.isEmpty())return ge.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(n,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,i)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),go=class{copy(e,n,i,r,s){return this}insert(e,n,i){return new Ee(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},ge=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Ee.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ee.BLACK,null,null))}get(e){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(e,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(e){let n,i=this.root_,r=null;for(;!i.isEmpty();)if(n=this.comparator_(e,i.key),n===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Bt(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Bt(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Bt(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Bt(this.root_,null,this.comparator_,!0,e)}};ge.EMPTY_NODE=new go;function l_(t,e){return vt(t.name,e.name)}function pa(t,e){return vt(t,e)}var _o;function c_(t){_o=t}var Nh=function(t){return typeof t=="number"?"number:"+dh(t):"string:"+t},Ph=function(t){if(t.isLeafNode()){let e=t.val();m(typeof e=="string"||typeof e=="number"||typeof e=="object"&&pe(e,".sv"),"Priority must be a string or number.")}else m(t===_o||t.isEmpty(),"priority of unexpected type.");m(t===_o||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var Vu,Vt=(()=>{class t{constructor(n,i=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=i,this.lazyHash_=null,m(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Ph(this.priorityNode_)}static set __childrenNodeConstructor(n){Vu=n}static get __childrenNodeConstructor(){return Vu}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return T(n)?this:C(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,i){return null}updateImmediateChild(n,i){return n===".priority"?this.updatePriority(i):i.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,i).updatePriority(this.priorityNode_)}updateChild(n,i){let r=C(n);return r===null?i:i.isEmpty()&&r!==".priority"?this:(m(r!==".priority"||nt(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(P(n),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,i){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+Nh(this.priorityNode_.val())+":");let i=typeof this.value_;n+=i+":",i==="number"?n+=dh(this.value_):n+=this.value_,this.lazyHash_=ch(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(m(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let i=typeof n.value_,r=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(i),o=t.VALUE_TYPE_ORDER.indexOf(r);return m(s>=0,"Unknown leaf type: "+i),m(o>=0,"Unknown leaf type: "+r),s===o?r==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let i=n;return this.value_===i.value_&&this.priorityNode_.equals(i.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),Oh,Dh;function u_(t){Oh=t}function h_(t){Dh=t}var vo=class extends Ht{compare(e,n){let i=e.node.getPriority(),r=n.node.getPriority(),s=i.compareTo(r);return s===0?vt(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return k.MIN}maxPost(){return new k(Be,new Vt("[PRIORITY-POST]",Dh))}makePost(e,n){let i=Oh(e);return new k(n,new Vt("[PRIORITY-POST]",i))}toString(){return".priority"}},O=new vo;var d_=Math.log(2),yo=class{constructor(e){let n=s=>parseInt(Math.log(s)/d_,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},hr=function(t,e,n,i){t.sort(e);let r=function(l,c){let u=c-l,h,d;if(u===0)return null;if(u===1)return h=t[l],d=n?n(h):h,new Ee(d,h.node,Ee.BLACK,null,null);{let f=parseInt(u/2,10)+l,p=r(l,f),v=r(f+1,c);return h=t[f],d=n?n(h):h,new Ee(d,h.node,Ee.BLACK,p,v)}},s=function(l){let c=null,u=null,h=t.length,d=function(p,v){let y=h-p,A=h;h-=p;let I=r(y+1,A),E=t[y],N=n?n(E):E;f(new Ee(N,E.node,v,null,I))},f=function(p){c?(c.left=p,c=p):(u=p,c=p)};for(let p=0;p<l.count;++p){let v=l.nextBitIsOne(),y=Math.pow(2,l.count-(p+1));v?d(y,Ee.BLACK):(d(y,Ee.BLACK),d(y,Ee.RED))}return u},o=new yo(t.length),a=s(o);return new ge(i||e,a)};var Js,Wt={},$t=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return m(Wt&&O,"ChildrenNode.ts has not been loaded"),Js=Js||new t({".priority":Wt},{".priority":O}),Js}get(e){let n=$e(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof ge?n:null}hasIndex(e){return pe(this.indexSet_,e.toString())}addIndex(e,n){m(e!==Ne,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let i=[],r=!1,s=n.getIterator(k.Wrap),o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),i.push(o),o=s.getNext();let a;r?a=hr(i,e.getCompare()):a=Wt;let l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;let u=Object.assign({},this.indexes_);return u[l]=a,new t(u,c)}addToIndexes(e,n){let i=on(this.indexes_,(r,s)=>{let o=$e(this.indexSet_,s);if(m(o,"Missing index implementation for "+s),r===Wt)if(o.isDefinedOn(e.node)){let a=[],l=n.getIterator(k.Wrap),c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),hr(a,o.getCompare())}else return Wt;else{let a=n.get(e.name),l=r;return a&&(l=l.remove(new k(e.name,a))),l.insert(e,e.node)}});return new t(i,this.indexSet_)}removeFromIndexes(e,n){let i=on(this.indexes_,r=>{if(r===Wt)return r;{let s=n.get(e.name);return s?r.remove(new k(e.name,s)):r}});return new t(i,this.indexSet_)}};var Sn,w=(()=>{class t{constructor(n,i,r){this.children_=n,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Ph(this.priorityNode_),this.children_.isEmpty()&&m(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Sn||(Sn=new t(new ge(pa),null,$t.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Sn}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let i=this.children_.get(n);return i===null?Sn:i}}getChild(n){let i=C(n);return i===null?this:this.getImmediateChild(i).getChild(P(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,i){if(m(i,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(i);{let r=new k(n,i),s,o;i.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(n,i),o=this.indexMap_.addToIndexes(r,this.children_));let a=s.isEmpty()?Sn:this.priorityNode_;return new t(s,a,o)}}updateChild(n,i){let r=C(n);if(r===null)return i;{m(C(n)!==".priority"||nt(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(r).updateChild(P(n),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let i={},r=0,s=0,o=!0;if(this.forEachChild(O,(a,l)=>{i[a]=l.val(n),r++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*r){let a=[];for(let l in i)a[l]=i[l];return a}else return n&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+Nh(this.getPriority().val())+":"),this.forEachChild(O,(i,r)=>{let s=r.hash();s!==""&&(n+=":"+i+":"+s)}),this.lazyHash_=n===""?"":ch(n)}return this.lazyHash_}getPredecessorChildName(n,i,r){let s=this.resolveIndex_(r);if(s){let o=s.getPredecessorKey(new k(n,i));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let i=this.resolveIndex_(n);if(i){let r=i.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(n){let i=this.getFirstChildName(n);return i?new k(i,this.children_.get(i)):null}getLastChildName(n){let i=this.resolveIndex_(n);if(i){let r=i.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(n){let i=this.getLastChildName(n);return i?new k(i,this.children_.get(i)):null}forEachChild(n,i){let r=this.resolveIndex_(n);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,i){let r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,k.Wrap),o=s.peek();for(;o!=null&&i.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,i){let r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,k.Wrap),o=s.peek();for(;o!=null&&i.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Qn?-1:0}withIndex(n){if(n===Ne||this.indexMap_.hasIndex(n))return this;{let i=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,i)}}isIndexed(n){return n===Ne||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let i=n;if(this.getPriority().equals(i.getPriority()))if(this.children_.count()===i.children_.count()){let r=this.getIterator(O),s=i.getIterator(O),o=r.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=r.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Ne?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),bo=class extends w{constructor(){super(new ge(pa),w.EMPTY_NODE,$t.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return w.EMPTY_NODE}isEmpty(){return!1}},Qn=new bo;Object.defineProperties(k,{MIN:{value:new k(tt,w.EMPTY_NODE)},MAX:{value:new k(Be,Qn)}});ur.__EMPTY_NODE=w.EMPTY_NODE;Vt.__childrenNodeConstructor=w;c_(Qn);h_(Qn);var f_=!0;function j(t,e=null){if(t===null)return w.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),m(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Vt(n,j(e))}if(!(t instanceof Array)&&f_){let n=[],i=!1;if(q(t,(o,a)=>{if(o.substring(0,1)!=="."){let l=j(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),n.push(new k(o,l)))}}),n.length===0)return w.EMPTY_NODE;let s=hr(n,l_,o=>o.name,pa);if(i){let o=hr(n,O.getCompare());return new w(s,j(e),new $t({".priority":o},{".priority":O}))}else return new w(s,j(e),$t.Default)}else{let n=w.EMPTY_NODE;return q(t,(i,r)=>{if(pe(t,i)&&i.substring(0,1)!=="."){let s=j(r);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(i,s))}}),n.updatePriority(j(e))}}u_(j);var Ln=class extends Ht{constructor(e){super(),this.indexPath_=e,m(!T(e)&&C(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let i=this.extractChild(e.node),r=this.extractChild(n.node),s=i.compareTo(r);return s===0?vt(e.name,n.name):s}makePost(e,n){let i=j(e),r=w.EMPTY_NODE.updateChild(this.indexPath_,i);return new k(n,r)}maxPost(){let e=w.EMPTY_NODE.updateChild(this.indexPath_,Qn);return new k(Be,e)}toString(){return Mn(this.indexPath_,0).join("/")}};var wo=class extends Ht{compare(e,n){let i=e.node.compareTo(n.node);return i===0?vt(e.name,n.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return k.MIN}maxPost(){return k.MAX}makePost(e,n){let i=j(e);return new k(n,i)}toString(){return".value"}},ma=new wo;function Mh(t){return{type:"value",snapshotNode:t}}function Gt(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Fn(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Un(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function p_(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Wn=class{constructor(e){this.index_=e}updateChild(e,n,i,r,s,o){m(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(r).equals(i.getChild(r))&&a.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?e.hasChild(n)?o.trackChildChange(Fn(n,a)):m(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Gt(n,i)):o.trackChildChange(Un(n,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(n,i).withIndex(this.index_)}updateFullNode(e,n,i){return i!=null&&(e.isLeafNode()||e.forEachChild(O,(r,s)=>{n.hasChild(r)||i.trackChildChange(Fn(r,s))}),n.isLeafNode()||n.forEachChild(O,(r,s)=>{if(e.hasChild(r)){let o=e.getImmediateChild(r);o.equals(s)||i.trackChildChange(Un(r,s,o))}else i.trackChildChange(Gt(r,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?w.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var dr=class t{constructor(e){this.indexedFilter_=new Wn(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&i}updateChild(e,n,i,r,s,o){return this.matches(new k(n,i))||(i=w.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,i,r,s,o)}updateFullNode(e,n,i){n.isLeafNode()&&(n=w.EMPTY_NODE);let r=n.withIndex(this.index_);r=r.updatePriority(w.EMPTY_NODE);let s=this;return n.forEachChild(O,(o,a)=>{s.matches(new k(o,a))||(r=r.updateImmediateChild(o,w.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var Eo=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let i=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=n=>{let i=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new dr(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,i,r,s,o){return this.rangedFilter_.matches(new k(n,i))||(i=w.EMPTY_NODE),e.getImmediateChild(n).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,i,r,s,o):this.fullLimitUpdateChild_(e,n,i,s,o)}updateFullNode(e,n,i){let r;if(n.isLeafNode()||n.isEmpty())r=w.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){r=w.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))r=r.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{r=n.withIndex(this.index_),r=r.updatePriority(w.EMPTY_NODE);let s;this.reverse_?s=r.getReverseIterator(this.index_):s=r.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:r=r.updateImmediateChild(a.name,w.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,i,r,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(d,f)=>h(f,d)}else o=this.index_.getCompare();let a=e;m(a.numChildren()===this.limit_,"");let l=new k(n,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(n)){let h=a.getImmediateChild(n),d=r.getChildAfterChild(this.index_,c,this.reverse_);for(;d!=null&&(d.name===n||a.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);let f=d==null?1:o(d,l);if(u&&!i.isEmpty()&&f>=0)return s?.trackChildChange(Un(n,i,h)),a.updateImmediateChild(n,i);{s?.trackChildChange(Fn(n,h));let v=a.updateImmediateChild(n,w.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(s?.trackChildChange(Gt(d.name,d.node)),v.updateImmediateChild(d.name,d.node)):v}}else return i.isEmpty()?e:u&&o(c,l)>=0?(s!=null&&(s.trackChildChange(Fn(c.name,c.node)),s.trackChildChange(Gt(n,i))),a.updateImmediateChild(n,i).updateImmediateChild(c.name,w.EMPTY_NODE)):e}};var jn=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=O}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return m(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return m(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:tt}hasEnd(){return this.endSet_}getIndexEndValue(){return m(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return m(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Be}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return m(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===O}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function m_(t){return t.loadsAllData()?new Wn(t.getIndex()):t.hasLimit()?new Eo(t):new dr(t)}function g_(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function __(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function Co(t,e,n){let i=t.copy();return i.startSet_=!0,e===void 0&&(e=null),i.indexStartValue_=e,n!=null?(i.startNameSet_=!0,i.indexStartName_=n):(i.startNameSet_=!1,i.indexStartName_=""),i}function v_(t,e,n){let i;return t.index_===Ne||n?i=Co(t,e,n):i=Co(t,e,Be),i.startAfterSet_=!0,i}function To(t,e,n){let i=t.copy();return i.endSet_=!0,e===void 0&&(e=null),i.indexEndValue_=e,n!==void 0?(i.endNameSet_=!0,i.indexEndName_=n):(i.endNameSet_=!1,i.indexEndName_=""),i}function y_(t,e,n){let i;return t.index_===Ne||n?i=To(t,e,n):i=To(t,e,tt),i.endBeforeSet_=!0,i}function Nr(t,e){let n=t.copy();return n.index_=e,n}function $u(t){let e={};if(t.isDefault())return e;let n;if(t.index_===O?n="$priority":t.index_===ma?n="$value":t.index_===Ne?n="$key":(m(t.index_ instanceof Ln,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=H(n),t.startSet_){let i=t.startAfterSet_?"startAfter":"startAt";e[i]=H(t.indexStartValue_),t.startNameSet_&&(e[i]+=","+H(t.indexStartName_))}if(t.endSet_){let i=t.endBeforeSet_?"endBefore":"endAt";e[i]=H(t.indexEndValue_),t.endNameSet_&&(e[i]+=","+H(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Gu(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==O&&(e.i=t.index_.toString()),e}var ko=class t extends ar{constructor(e,n,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=Kn("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(m(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,i,r){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,i),a={};this.listens_[o]=a;let l=$u(e._queryParams);this.restRequest_(s+".json",l,(c,u)=>{let h=u;if(c===404&&(h=null,c=null),c===null&&this.onDataUpdate_(s,h,!1,i),$e(this.listens_,o)===a){let d;c?c===401?d="permission_denied":d="rest_error:"+c:d="ok",r(d,null)}})}unlisten(e,n){let i=t.getListenId_(e,n);delete this.listens_[i]}get(e){let n=$u(e._queryParams),i=e._path.toString(),r=new X;return this.restRequest_(i+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(n.auth=r.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ml(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=fi(a.responseText)}catch{Q("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&Q("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}};var Io=class{constructor(){this.rootNode_=w.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function fr(){return{value:null,children:new Map}}function Jt(t,e,n){if(T(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let i=C(e);t.children.has(i)||t.children.set(i,fr());let r=t.children.get(i);e=P(e),Jt(r,e,n)}}function So(t,e){if(T(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(O,(i,r)=>{Jt(t,new x(i),r)}),So(t,e)}}else if(t.children.size>0){let n=C(e);return e=P(e),t.children.has(n)&&So(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function Ro(t,e,n){t.value!==null?n(e,t.value):b_(t,(i,r)=>{let s=new x(e.toString()+"/"+i);Ro(r,s,n)})}function b_(t,e){t.children.forEach((n,i)=>{e(i,n)})}var xo=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&q(this.last_,(i,r)=>{n[i]=n[i]-r}),this.last_=e,n}};var qu=10*1e3,w_=30*1e3,E_=5*60*1e3,Ao=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new xo(e);let i=qu+(w_-qu)*Math.random();xn(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let e=this.statsListener_.get(),n={},i=!1;q(e,(r,s)=>{s>0&&pe(this.statsToReport_,r)&&(n[r]=s,i=!0)}),i&&this.server_.reportStats(n),xn(this.reportStats_.bind(this),Math.floor(Math.random()*2*E_))}};var Ae=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Ae||{});function ga(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function _a(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function va(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var No=class t{constructor(e,n,i){this.path=e,this.affectedTree=n,this.revert=i,this.type=Ae.ACK_USER_WRITE,this.source=ga()}operationForChild(e){if(T(this.path)){if(this.affectedTree.value!=null)return m(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new x(e));return new t(R(),n,this.revert)}}else return m(C(this.path)===e,"operationForChild called for unrelated child."),new t(P(this.path),this.affectedTree,this.revert)}};var pr=class t{constructor(e,n){this.source=e,this.path=n,this.type=Ae.LISTEN_COMPLETE}operationForChild(e){return T(this.path)?new t(this.source,R()):new t(this.source,P(this.path))}};var qt=class t{constructor(e,n,i){this.source=e,this.path=n,this.snap=i,this.type=Ae.OVERWRITE}operationForChild(e){return T(this.path)?new t(this.source,R(),this.snap.getImmediateChild(e)):new t(this.source,P(this.path),this.snap)}};var Bn=class t{constructor(e,n,i){this.source=e,this.path=n,this.children=i,this.type=Ae.MERGE}operationForChild(e){if(T(this.path)){let n=this.children.subtree(new x(e));return n.isEmpty()?null:n.value?new qt(this.source,R(),n.value):new t(this.source,R(),n)}else return m(C(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,P(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Oe=class{constructor(e,n,i){this.node_=e,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(T(e))return this.isFullyInitialized()&&!this.filtered_;let n=C(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var Po=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function C_(t,e,n,i){let r=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(p_(o.childName,o.snapshotNode))}),Rn(t,r,"child_removed",e,i,n),Rn(t,r,"child_added",e,i,n),Rn(t,r,"child_moved",s,i,n),Rn(t,r,"child_changed",e,i,n),Rn(t,r,"value",e,i,n),r}function Rn(t,e,n,i,r,s){let o=i.filter(a=>a.type===n);o.sort((a,l)=>k_(t,a,l)),o.forEach(a=>{let l=T_(t,a,s);r.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function T_(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function k_(t,e,n){if(e.childName==null||n.childName==null)throw Tt("Should only compare child_ events.");let i=new k(e.childName,e.snapshotNode),r=new k(n.childName,n.snapshotNode);return t.index_.compare(i,r)}function Pr(t,e){return{eventCache:t,serverCache:e}}function Nn(t,e,n,i){return Pr(new Oe(e,n,i),t.serverCache)}function Lh(t,e,n,i){return Pr(t.eventCache,new Oe(e,n,i))}function mr(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function _t(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var Zs,I_=()=>(Zs||(Zs=new ge(Tg)),Zs),ee=class t{constructor(e,n=I_()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return q(e,(i,r)=>{n=n.set(new x(i),r)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:R(),value:this.value};if(T(e))return null;{let i=C(e),r=this.children.get(i);if(r!==null){let s=r.findRootMostMatchingPathAndValue(P(e),n);return s!=null?{path:F(new x(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(T(e))return this;{let n=C(e),i=this.children.get(n);return i!==null?i.subtree(P(e)):new t(null)}}set(e,n){if(T(e))return new t(n,this.children);{let i=C(e),s=(this.children.get(i)||new t(null)).set(P(e),n),o=this.children.insert(i,s);return new t(this.value,o)}}remove(e){if(T(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=C(e),i=this.children.get(n);if(i){let r=i.remove(P(e)),s;return r.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,r),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(T(e))return this.value;{let n=C(e),i=this.children.get(n);return i?i.get(P(e)):null}}setTree(e,n){if(T(e))return n;{let i=C(e),s=(this.children.get(i)||new t(null)).setTree(P(e),n),o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new t(this.value,o)}}fold(e){return this.fold_(R(),e)}fold_(e,n){let i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(F(e,r),n)}),n(e,this.value,i)}findOnPath(e,n){return this.findOnPath_(e,R(),n)}findOnPath_(e,n,i){let r=this.value?i(n,this.value):!1;if(r)return r;if(T(e))return null;{let s=C(e),o=this.children.get(s);return o?o.findOnPath_(P(e),F(n,s),i):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,R(),n)}foreachOnPath_(e,n,i){if(T(e))return this;{this.value&&i(n,this.value);let r=C(e),s=this.children.get(r);return s?s.foreachOnPath_(P(e),F(n,r),i):new t(null)}}foreach(e){this.foreach_(R(),e)}foreach_(e,n){this.children.inorderTraversal((i,r)=>{r.foreach_(F(e,i),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,i)=>{i.value&&e(n,i.value)})}};var Ce=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new ee(null))}};function Pn(t,e,n){if(T(e))return new Ce(new ee(n));{let i=t.writeTree_.findRootMostValueAndPath(e);if(i!=null){let r=i.path,s=i.value,o=Z(r,e);return s=s.updateChild(o,n),new Ce(t.writeTree_.set(r,s))}else{let r=new ee(n),s=t.writeTree_.setTree(e,r);return new Ce(s)}}}function Oo(t,e,n){let i=t;return q(n,(r,s)=>{i=Pn(i,F(e,r),s)}),i}function Yu(t,e){if(T(e))return Ce.empty();{let n=t.writeTree_.setTree(e,new ee(null));return new Ce(n)}}function Do(t,e){return yt(t,e)!=null}function yt(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Z(n.path,e)):null}function Ku(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(O,(i,r)=>{e.push(new k(i,r))}):t.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new k(i,r.value))}),e}function Ze(t,e){if(T(e))return t;{let n=yt(t,e);return n!=null?new Ce(new ee(n)):new Ce(t.writeTree_.subtree(e))}}function Mo(t){return t.writeTree_.isEmpty()}function Yt(t,e){return Fh(R(),t.writeTree_,e)}function Fh(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(m(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):n=Fh(F(t,r),s,n)}),!n.getChild(t).isEmpty()&&i!==null&&(n=n.updateChild(F(t,".priority"),i)),n}}function Or(t,e){return Bh(e,t)}function S_(t,e,n,i,r){m(i>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:r}),r&&(t.visibleWrites=Pn(t.visibleWrites,e,n)),t.lastWriteId=i}function R_(t,e,n,i){m(i>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:i,visible:!0}),t.visibleWrites=Oo(t.visibleWrites,e,n),t.lastWriteId=i}function x_(t,e){for(let n=0;n<t.allWrites.length;n++){let i=t.allWrites[n];if(i.writeId===e)return i}return null}function A_(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);m(n>=0,"removeWrite called with nonexistent writeId.");let i=t.allWrites[n];t.allWrites.splice(n,1);let r=i.visible,s=!1,o=t.allWrites.length-1;for(;r&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&N_(a,i.path)?r=!1:me(i.path,a.path)&&(s=!0)),o--}if(r){if(s)return P_(t),!0;if(i.snap)t.visibleWrites=Yu(t.visibleWrites,i.path);else{let a=i.children;q(a,l=>{t.visibleWrites=Yu(t.visibleWrites,F(i.path,l))})}return!0}else return!1}function N_(t,e){if(t.snap)return me(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&me(F(t.path,n),e))return!0;return!1}function P_(t){t.visibleWrites=Uh(t.allWrites,O_,R()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function O_(t){return t.visible}function Uh(t,e,n){let i=Ce.empty();for(let r=0;r<t.length;++r){let s=t[r];if(e(s)){let o=s.path,a;if(s.snap)me(n,o)?(a=Z(n,o),i=Pn(i,a,s.snap)):me(o,n)&&(a=Z(o,n),i=Pn(i,R(),s.snap.getChild(a)));else if(s.children){if(me(n,o))a=Z(n,o),i=Oo(i,a,s.children);else if(me(o,n))if(a=Z(o,n),T(a))i=Oo(i,R(),s.children);else{let l=$e(s.children,C(a));if(l){let c=l.getChild(P(a));i=Pn(i,R(),c)}}}else throw Tt("WriteRecord should have .snap or .children")}}return i}function Wh(t,e,n,i,r){if(!i&&!r){let s=yt(t.visibleWrites,e);if(s!=null)return s;{let o=Ze(t.visibleWrites,e);if(Mo(o))return n;if(n==null&&!Do(o,R()))return null;{let a=n||w.EMPTY_NODE;return Yt(o,a)}}}else{let s=Ze(t.visibleWrites,e);if(!r&&Mo(s))return n;if(!r&&n==null&&!Do(s,R()))return null;{let o=function(c){return(c.visible||r)&&(!i||!~i.indexOf(c.writeId))&&(me(c.path,e)||me(e,c.path))},a=Uh(t.allWrites,o,e),l=n||w.EMPTY_NODE;return Yt(a,l)}}}function D_(t,e,n){let i=w.EMPTY_NODE,r=yt(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(O,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(n){let s=Ze(t.visibleWrites,e);return n.forEachChild(O,(o,a)=>{let l=Yt(Ze(s,new x(o)),a);i=i.updateImmediateChild(o,l)}),Ku(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{let s=Ze(t.visibleWrites,e);return Ku(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function M_(t,e,n,i,r){m(i||r,"Either existingEventSnap or existingServerSnap must exist");let s=F(e,n);if(Do(t.visibleWrites,s))return null;{let o=Ze(t.visibleWrites,s);return Mo(o)?r.getChild(n):Yt(o,r.getChild(n))}}function L_(t,e,n,i){let r=F(e,n),s=yt(t.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(n)){let o=Ze(t.visibleWrites,r);return Yt(o,i.getNode().getImmediateChild(n))}else return null}function F_(t,e){return yt(t.visibleWrites,e)}function U_(t,e,n,i,r,s,o){let a,l=Ze(t.visibleWrites,e),c=yt(l,R());if(c!=null)a=c;else if(n!=null)a=Yt(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let u=[],h=o.getCompare(),d=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o),f=d.getNext();for(;f&&u.length<r;)h(f,i)!==0&&u.push(f),f=d.getNext();return u}else return[]}function W_(){return{visibleWrites:Ce.empty(),allWrites:[],lastWriteId:-1}}function gr(t,e,n,i){return Wh(t.writeTree,t.treePath,e,n,i)}function ya(t,e){return D_(t.writeTree,t.treePath,e)}function Qu(t,e,n,i){return M_(t.writeTree,t.treePath,e,n,i)}function _r(t,e){return F_(t.writeTree,F(t.treePath,e))}function j_(t,e,n,i,r,s){return U_(t.writeTree,t.treePath,e,n,i,r,s)}function ba(t,e,n){return L_(t.writeTree,t.treePath,e,n)}function jh(t,e){return Bh(F(t.treePath,e),t.writeTree)}function Bh(t,e){return{treePath:t,writeTree:e}}var Lo=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,i=e.childName;m(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),m(i!==".priority","Only non-priority child changes can be tracked.");let r=this.changeMap.get(i);if(r){let s=r.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(i,Un(i,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(i,Fn(i,r.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(i,Gt(i,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(i,Un(i,e.snapshotNode,r.oldSnap));else throw Tt("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}};var Fo=class{getCompleteChild(e){return null}getChildAfterChild(e,n,i){return null}},zh=new Fo,zn=class{constructor(e,n,i=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let i=this.optCompleteServerCache_!=null?new Oe(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ba(this.writes_,e,i)}}getChildAfterChild(e,n,i){let r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:_t(this.viewCache_),s=j_(this.writes_,r,n,1,i,e);return s.length===0?null:s[0]}};function B_(t){return{filter:t}}function z_(t,e){m(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),m(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function H_(t,e,n,i,r){let s=new Lo,o,a;if(n.type===Ae.OVERWRITE){let c=n;c.source.fromUser?o=Uo(t,e,c.path,c.snap,i,r,s):(m(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!T(c.path),o=vr(t,e,c.path,c.snap,i,r,a,s))}else if(n.type===Ae.MERGE){let c=n;c.source.fromUser?o=$_(t,e,c.path,c.children,i,r,s):(m(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=Wo(t,e,c.path,c.children,i,r,a,s))}else if(n.type===Ae.ACK_USER_WRITE){let c=n;c.revert?o=Y_(t,e,c.path,i,r,s):o=G_(t,e,c.path,c.affectedTree,i,r,s)}else if(n.type===Ae.LISTEN_COMPLETE)o=q_(t,e,n.path,i,s);else throw Tt("Unknown operation type: "+n.type);let l=s.getChanges();return V_(e,o,l),{viewCache:o,changes:l}}function V_(t,e,n){let i=e.eventCache;if(i.isFullyInitialized()){let r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=mr(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(Mh(mr(e)))}}function Hh(t,e,n,i,r,s){let o=e.eventCache;if(_r(i,n)!=null)return e;{let a,l;if(T(n))if(m(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=_t(e),u=c instanceof w?c:w.EMPTY_NODE,h=ya(i,u);a=t.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let c=gr(i,_t(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=C(n);if(c===".priority"){m(nt(n)===1,"Can't have a priority with additional path components");let u=o.getNode();l=e.serverCache.getNode();let h=Qu(i,n,u,l);h!=null?a=t.filter.updatePriority(u,h):a=o.getNode()}else{let u=P(n),h;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();let d=Qu(i,n,o.getNode(),l);d!=null?h=o.getNode().getImmediateChild(c).updateChild(u,d):h=o.getNode().getImmediateChild(c)}else h=ba(i,c,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),c,h,u,r,s):a=o.getNode()}}return Nn(e,a,o.isFullyInitialized()||T(n),t.filter.filtersNodes())}}function vr(t,e,n,i,r,s,o,a){let l=e.serverCache,c,u=o?t.filter:t.filter.getIndexedFilter();if(T(n))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){let f=l.getNode().updateChild(n,i);c=u.updateFullNode(l.getNode(),f,null)}else{let f=C(n);if(!l.isCompleteForPath(n)&&nt(n)>1)return e;let p=P(n),y=l.getNode().getImmediateChild(f).updateChild(p,i);f===".priority"?c=u.updatePriority(l.getNode(),y):c=u.updateChild(l.getNode(),f,y,p,zh,null)}let h=Lh(e,c,l.isFullyInitialized()||T(n),u.filtersNodes()),d=new zn(r,h,s);return Hh(t,h,n,r,d,a)}function Uo(t,e,n,i,r,s,o){let a=e.eventCache,l,c,u=new zn(r,e,s);if(T(n))c=t.filter.updateFullNode(e.eventCache.getNode(),i,o),l=Nn(e,c,!0,t.filter.filtersNodes());else{let h=C(n);if(h===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),i),l=Nn(e,c,a.isFullyInitialized(),a.isFiltered());else{let d=P(n),f=a.getNode().getImmediateChild(h),p;if(T(d))p=i;else{let v=u.getCompleteChild(h);v!=null?ha(d)===".priority"&&v.getChild(xh(d)).isEmpty()?p=v:p=v.updateChild(d,i):p=w.EMPTY_NODE}if(f.equals(p))l=e;else{let v=t.filter.updateChild(a.getNode(),h,p,d,u,o);l=Nn(e,v,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function Xu(t,e){return t.eventCache.isCompleteForChild(e)}function $_(t,e,n,i,r,s,o){let a=e;return i.foreach((l,c)=>{let u=F(n,l);Xu(e,C(u))&&(a=Uo(t,a,u,c,r,s,o))}),i.foreach((l,c)=>{let u=F(n,l);Xu(e,C(u))||(a=Uo(t,a,u,c,r,s,o))}),a}function Ju(t,e,n){return n.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function Wo(t,e,n,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;T(n)?c=i:c=new ee(null).setTree(n,i);let u=e.serverCache.getNode();return c.children.inorderTraversal((h,d)=>{if(u.hasChild(h)){let f=e.serverCache.getNode().getImmediateChild(h),p=Ju(t,f,d);l=vr(t,l,new x(h),p,r,s,o,a)}}),c.children.inorderTraversal((h,d)=>{let f=!e.serverCache.isCompleteForChild(h)&&d.value===null;if(!u.hasChild(h)&&!f){let p=e.serverCache.getNode().getImmediateChild(h),v=Ju(t,p,d);l=vr(t,l,new x(h),v,r,s,o,a)}}),l}function G_(t,e,n,i,r,s,o){if(_r(r,n)!=null)return e;let a=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(T(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return vr(t,e,n,l.getNode().getChild(n),r,s,a,o);if(T(n)){let c=new ee(null);return l.getNode().forEachChild(Ne,(u,h)=>{c=c.set(new x(u),h)}),Wo(t,e,n,c,r,s,a,o)}else return e}else{let c=new ee(null);return i.foreach((u,h)=>{let d=F(n,u);l.isCompleteForPath(d)&&(c=c.set(u,l.getNode().getChild(d)))}),Wo(t,e,n,c,r,s,a,o)}}function q_(t,e,n,i,r){let s=e.serverCache,o=Lh(e,s.getNode(),s.isFullyInitialized()||T(n),s.isFiltered());return Hh(t,o,n,i,zh,r)}function Y_(t,e,n,i,r,s){let o;if(_r(i,n)!=null)return e;{let a=new zn(i,e,r),l=e.eventCache.getNode(),c;if(T(n)||C(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=gr(i,_t(e));else{let h=e.serverCache.getNode();m(h instanceof w,"serverChildren would be complete if leaf node"),u=ya(i,h)}u=u,c=t.filter.updateFullNode(l,u,s)}else{let u=C(n),h=ba(i,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=l.getImmediateChild(u)),h!=null?c=t.filter.updateChild(l,u,h,P(n),a,s):e.eventCache.getNode().hasChild(u)?c=t.filter.updateChild(l,u,w.EMPTY_NODE,P(n),a,s):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=gr(i,_t(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||_r(i,R())!=null,Nn(e,c,o,t.filter.filtersNodes())}}var jo=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let i=this.query_._queryParams,r=new Wn(i.getIndex()),s=m_(i);this.processor_=B_(s);let o=n.serverCache,a=n.eventCache,l=r.updateFullNode(w.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(w.EMPTY_NODE,a.getNode(),null),u=new Oe(l,o.isFullyInitialized(),r.filtersNodes()),h=new Oe(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Pr(h,u),this.eventGenerator_=new Po(this.query_)}get query(){return this.query_}};function K_(t){return t.viewCache_.serverCache.getNode()}function Q_(t){return mr(t.viewCache_)}function X_(t,e){let n=_t(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!T(e)&&!n.getImmediateChild(C(e)).isEmpty())?n.getChild(e):null}function Zu(t){return t.eventRegistrations_.length===0}function J_(t,e){t.eventRegistrations_.push(e)}function eh(t,e,n){let i=[];if(n){m(e==null,"A cancel should cancel all event registrations.");let r=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,r);o&&i.push(o)})}if(e){let r=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=r}else t.eventRegistrations_=[];return i}function th(t,e,n,i){e.type===Ae.MERGE&&e.source.queryId!==null&&(m(_t(t.viewCache_),"We should always have a full cache before handling merges"),m(mr(t.viewCache_),"Missing event cache, even though we have a server cache"));let r=t.viewCache_,s=H_(t.processor_,r,e,n,i);return z_(t.processor_,s.viewCache),m(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,Vh(t,s.changes,s.viewCache.eventCache.getNode(),null)}function Z_(t,e){let n=t.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(O,(s,o)=>{i.push(Gt(s,o))}),n.isFullyInitialized()&&i.push(Mh(n.getNode())),Vh(t,i,n.getNode(),e)}function Vh(t,e,n,i){let r=i?[i]:t.eventRegistrations_;return C_(t.eventGenerator_,e,n,r)}var yr,br=class{constructor(){this.views=new Map}};function ev(t){m(!yr,"__referenceConstructor has already been defined"),yr=t}function tv(){return m(yr,"Reference.ts has not been loaded"),yr}function nv(t){return t.views.size===0}function wa(t,e,n,i){let r=e.source.queryId;if(r!==null){let s=t.views.get(r);return m(s!=null,"SyncTree gave us an op for an invalid query."),th(s,e,n,i)}else{let s=[];for(let o of t.views.values())s=s.concat(th(o,e,n,i));return s}}function $h(t,e,n,i,r){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=gr(n,r?i:null),l=!1;a?l=!0:i instanceof w?(a=ya(n,i),l=!1):(a=w.EMPTY_NODE,l=!1);let c=Pr(new Oe(a,l,!1),new Oe(i,r,!1));return new jo(e,c)}return o}function iv(t,e,n,i,r,s){let o=$h(t,e,i,r,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),J_(o,n),Z_(o,n)}function rv(t,e,n,i){let r=e._queryIdentifier,s=[],o=[],a=it(t);if(r==="default")for(let[l,c]of t.views.entries())o=o.concat(eh(c,n,i)),Zu(c)&&(t.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{let l=t.views.get(r);l&&(o=o.concat(eh(l,n,i)),Zu(l)&&(t.views.delete(r),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!it(t)&&s.push(new(tv())(e._repo,e._path)),{removed:s,events:o}}function Gh(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function et(t,e){let n=null;for(let i of t.views.values())n=n||X_(i,e);return n}function qh(t,e){if(e._queryParams.loadsAllData())return Dr(t);{let i=e._queryIdentifier;return t.views.get(i)}}function Yh(t,e){return qh(t,e)!=null}function it(t){return Dr(t)!=null}function Dr(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var wr;function sv(t){m(!wr,"__referenceConstructor has already been defined"),wr=t}function ov(){return m(wr,"Reference.ts has not been loaded"),wr}var av=1,Er=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ee(null),this.pendingWriteTree_=W_(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function Ea(t,e,n,i,r){return S_(t.pendingWriteTree_,e,n,i,r),r?Zt(t,new qt(ga(),e,n)):[]}function lv(t,e,n,i){R_(t.pendingWriteTree_,e,n,i);let r=ee.fromObject(n);return Zt(t,new Bn(ga(),e,r))}function Je(t,e,n=!1){let i=x_(t.pendingWriteTree_,e);if(A_(t.pendingWriteTree_,e)){let s=new ee(null);return i.snap!=null?s=s.set(R(),!0):q(i.children,o=>{s=s.set(new x(o),!0)}),Zt(t,new No(i.path,s,n))}else return[]}function Xn(t,e,n){return Zt(t,new qt(_a(),e,n))}function cv(t,e,n){let i=ee.fromObject(n);return Zt(t,new Bn(_a(),e,i))}function uv(t,e){return Zt(t,new pr(_a(),e))}function hv(t,e,n){let i=Ca(t,n);if(i){let r=Ta(i),s=r.path,o=r.queryId,a=Z(s,e),l=new pr(va(o),a);return ka(t,s,l)}else return[]}function Cr(t,e,n,i,r=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||Yh(o,e))){let l=rv(o,e,n,i);nv(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let c=l.removed;if(a=l.events,!r){let u=c.findIndex(d=>d._queryParams.loadsAllData())!==-1,h=t.syncPointTree_.findOnPath(s,(d,f)=>it(f));if(u&&!h){let d=t.syncPointTree_.subtree(s);if(!d.isEmpty()){let f=pv(d);for(let p=0;p<f.length;++p){let v=f[p],y=v.query,A=Jh(t,v);t.listenProvider_.startListening(On(y),Hn(t,y),A.hashFn,A.onComplete)}}}!h&&c.length>0&&!i&&(u?t.listenProvider_.stopListening(On(e),null):c.forEach(d=>{let f=t.queryToTagMap.get(Lr(d));t.listenProvider_.stopListening(On(d),f)}))}mv(t,c)}return a}function Kh(t,e,n,i){let r=Ca(t,i);if(r!=null){let s=Ta(r),o=s.path,a=s.queryId,l=Z(o,e),c=new qt(va(a),l,n);return ka(t,o,c)}else return[]}function dv(t,e,n,i){let r=Ca(t,i);if(r){let s=Ta(r),o=s.path,a=s.queryId,l=Z(o,e),c=ee.fromObject(n),u=new Bn(va(a),l,c);return ka(t,o,u)}else return[]}function Bo(t,e,n,i=!1){let r=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(r,(d,f)=>{let p=Z(d,r);s=s||et(f,p),o=o||it(f)});let a=t.syncPointTree_.get(r);a?(o=o||it(a),s=s||et(a,R())):(a=new br,t.syncPointTree_=t.syncPointTree_.set(r,a));let l;s!=null?l=!0:(l=!1,s=w.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((f,p)=>{let v=et(p,R());v&&(s=s.updateImmediateChild(f,v))}));let c=Yh(a,e);if(!c&&!e._queryParams.loadsAllData()){let d=Lr(e);m(!t.queryToTagMap.has(d),"View does not exist, but we have a tag");let f=gv();t.queryToTagMap.set(d,f),t.tagToQueryMap.set(f,d)}let u=Or(t.pendingWriteTree_,r),h=iv(a,e,n,u,s,l);if(!c&&!o&&!i){let d=qh(a,e);h=h.concat(_v(t,e,d))}return h}function Mr(t,e,n){let r=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let l=Z(o,e),c=et(a,l);if(c)return c});return Wh(r,e,s,n,!0)}function fv(t,e){let n=e._path,i=null;t.syncPointTree_.foreachOnPath(n,(c,u)=>{let h=Z(c,n);i=i||et(u,h)});let r=t.syncPointTree_.get(n);r?i=i||et(r,R()):(r=new br,t.syncPointTree_=t.syncPointTree_.set(n,r));let s=i!=null,o=s?new Oe(i,!0,!1):null,a=Or(t.pendingWriteTree_,e._path),l=$h(r,e,a,s?o.getNode():w.EMPTY_NODE,s);return Q_(l)}function Zt(t,e){return Qh(e,t.syncPointTree_,null,Or(t.pendingWriteTree_,R()))}function Qh(t,e,n,i){if(T(t.path))return Xh(t,e,n,i);{let r=e.get(R());n==null&&r!=null&&(n=et(r,R()));let s=[],o=C(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){let c=n?n.getImmediateChild(o):null,u=jh(i,o);s=s.concat(Qh(a,l,c,u))}return r&&(s=s.concat(wa(r,t,i,n))),s}}function Xh(t,e,n,i){let r=e.get(R());n==null&&r!=null&&(n=et(r,R()));let s=[];return e.children.inorderTraversal((o,a)=>{let l=n?n.getImmediateChild(o):null,c=jh(i,o),u=t.operationForChild(o);u&&(s=s.concat(Xh(u,a,l,c)))}),r&&(s=s.concat(wa(r,t,i,n))),s}function Jh(t,e){let n=e.query,i=Hn(t,n);return{hashFn:()=>(K_(e)||w.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return i?hv(t,n._path,i):uv(t,n._path);{let s=Sg(r,n);return Cr(t,n,null,s)}}}}function Hn(t,e){let n=Lr(e);return t.queryToTagMap.get(n)}function Lr(t){return t._path.toString()+"$"+t._queryIdentifier}function Ca(t,e){return t.tagToQueryMap.get(e)}function Ta(t){let e=t.indexOf("$");return m(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new x(t.substr(0,e))}}function ka(t,e,n){let i=t.syncPointTree_.get(e);m(i,"Missing sync point for query tag that we're tracking");let r=Or(t.pendingWriteTree_,e);return wa(i,n,r,null)}function pv(t){return t.fold((e,n,i)=>{if(n&&it(n))return[Dr(n)];{let r=[];return n&&(r=Gh(n)),q(i,(s,o)=>{r=r.concat(o)}),r}})}function On(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(ov())(t._repo,t._path):t}function mv(t,e){for(let n=0;n<e.length;++n){let i=e[n];if(!i._queryParams.loadsAllData()){let r=Lr(i),s=t.queryToTagMap.get(r);t.queryToTagMap.delete(r),t.tagToQueryMap.delete(s)}}}function gv(){return av++}function _v(t,e,n){let i=e._path,r=Hn(t,e),s=Jh(t,n),o=t.listenProvider_.startListening(On(e),r,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(i);if(r)m(!it(a.value),"If we're adding a query, it shouldn't be shadowed");else{let l=a.fold((c,u,h)=>{if(!T(c)&&u&&it(u))return[Dr(u).query];{let d=[];return u&&(d=d.concat(Gh(u).map(f=>f.query))),q(h,(f,p)=>{d=d.concat(p)}),d}});for(let c=0;c<l.length;++c){let u=l[c];t.listenProvider_.stopListening(On(u),Hn(t,u))}}return o}var zo=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},Ho=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=F(this.path_,e);return new t(this.syncTree_,n)}node(){return Mr(this.syncTree_,this.path_)}},vv=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},nh=function(t,e,n){if(!t||typeof t!="object")return t;if(m(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return yv(t[".sv"],e,n);if(typeof t[".sv"]=="object")return bv(t[".sv"],e);m(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},yv=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:m(!1,"Unexpected server value: "+t)}},bv=function(t,e,n){t.hasOwnProperty("increment")||m(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let i=t.increment;typeof i!="number"&&m(!1,"Unexpected increment value: "+i);let r=e.node();if(m(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;let o=r.getValue();return typeof o!="number"?i:o+i},Zh=function(t,e,n,i){return Sa(e,new Ho(n,t),i)},Ia=function(t,e,n){return Sa(t,new zo(e),n)};function Sa(t,e,n){let i=t.getPriority().val(),r=nh(i,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=nh(o.getValue(),e,n);return a!==o.getValue()||r!==o.getPriority().val()?new Vt(a,j(r)):t}else{let o=t;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new Vt(r))),o.forEachChild(O,(a,l)=>{let c=Sa(l,e.getImmediateChild(a),n);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}var Vn=class{constructor(e="",n=null,i={children:{},childCount:0}){this.name=e,this.parent=n,this.node=i}};function Fr(t,e){let n=e instanceof x?e:new x(e),i=t,r=C(n);for(;r!==null;){let s=$e(i.node.children,r)||{children:{},childCount:0};i=new Vn(r,i,s),n=P(n),r=C(n)}return i}function bt(t){return t.node.value}function Ra(t,e){t.node.value=e,Vo(t)}function ed(t){return t.node.childCount>0}function wv(t){return bt(t)===void 0&&!ed(t)}function Ur(t,e){q(t.node.children,(n,i)=>{e(new Vn(n,t,i))})}function td(t,e,n,i){n&&!i&&e(t),Ur(t,r=>{td(r,e,!0,i)}),n&&i&&e(t)}function Ev(t,e,n){let i=n?t:t.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Jn(t){return new x(t.parent===null?t.name:Jn(t.parent)+"/"+t.name)}function Vo(t){t.parent!==null&&Cv(t.parent,t.name,t)}function Cv(t,e,n){let i=wv(n),r=pe(t.node.children,e);i&&r?(delete t.node.children[e],t.node.childCount--,Vo(t)):!i&&!r&&(t.node.children[e]=n.node,t.node.childCount++,Vo(t))}var Tv=/[\[\].#$\/\u0000-\u001F\u007F]/,kv=/[\[\].#$\u0000-\u001F\u007F]/,eo=10*1024*1024,Wr=function(t){return typeof t=="string"&&t.length!==0&&!Tv.test(t)},nd=function(t){return typeof t=="string"&&t.length!==0&&!kv.test(t)},Iv=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),nd(t)},$n=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Ar(t)||t&&typeof t=="object"&&pe(t,".sv")},De=function(t,e,n,i){i&&e===void 0||Zn(se(t,"value"),e,n)},Zn=function(t,e,n){let i=n instanceof x?new po(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+pt(i));if(typeof e=="function")throw new Error(t+"contains a function "+pt(i)+" with contents = "+e.toString());if(Ar(e))throw new Error(t+"contains "+e.toString()+" "+pt(i));if(typeof e=="string"&&e.length>eo/3&&an(e)>eo)throw new Error(t+"contains a string greater than "+eo+" utf8 bytes "+pt(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(q(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Wr(o)))throw new Error(t+" contains an invalid key ("+o+") "+pt(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);n_(i,o),Zn(t,a,i),i_(i)}),r&&s)throw new Error(t+' contains ".value" child '+pt(i)+" in addition to actual children.")}},Sv=function(t,e){let n,i;for(n=0;n<e.length;n++){i=e[n];let s=Mn(i);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Wr(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(t_);let r=null;for(n=0;n<e.length;n++){if(i=e[n],r!==null&&me(r,i))throw new Error(t+"contains a path "+r.toString()+" that is ancestor of another path "+i.toString());r=i}},id=function(t,e,n,i){if(i&&e===void 0)return;let r=se(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");let s=[];q(e,(o,a)=>{let l=new x(o);if(Zn(r,a,F(n,l)),ha(l)===".priority"&&!$n(a))throw new Error(r+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(l)}),Sv(r,s)},xa=function(t,e,n){if(!(n&&e===void 0)){if(Ar(e))throw new Error(se(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!$n(e))throw new Error(se(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},ei=function(t,e,n,i){if(!(i&&n===void 0)&&!Wr(n))throw new Error(se(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},en=function(t,e,n,i){if(!(i&&n===void 0)&&!nd(n))throw new Error(se(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Rv=function(t,e,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),en(t,e,n,i)},le=function(t,e){if(C(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},rd=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Wr(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!Iv(n))throw new Error(se(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var $o=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function jr(t,e){let n=null;for(let i=0;i<e.length;i++){let r=e[i],s=r.getPath();n!==null&&!da(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(r)}n&&t.eventLists_.push(n)}function sd(t,e,n){jr(t,n),od(t,i=>da(i,e))}function ce(t,e,n){jr(t,n),od(t,i=>me(i,e)||me(e,i))}function od(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){let r=t.eventLists_[i];if(r){let s=r.path;e(s)?(xv(t.eventLists_[i]),t.eventLists_[i]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function xv(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let i=n.getEventRunner();gt&&G("event: "+n.toString()),Xt(i)}}}var ad="repo_interrupt",Av=25,Go=class{constructor(e,n,i,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new $o,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=fr(),this.transactionQueueTree_=new Vn,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function Nv(t,e,n){if(t.stats_=ua(t.repoInfo_),t.forceRestClient_||Ng())t.server_=new ko(t.repoInfo_,(i,r,s,o)=>{ih(t,i,r,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>rh(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{H(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}t.persistentConnection_=new fa(t.repoInfo_,e,(i,r,s,o)=>{ih(t,i,r,s,o)},i=>{rh(t,i)},i=>{Pv(t,i)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(i=>{t.server_.refreshAuthToken(i)}),t.appCheckProvider_.addTokenChangeListener(i=>{t.server_.refreshAppCheckToken(i.token)}),t.statsReporter_=Og(t.repoInfo_,()=>new Ao(t.stats_,t.server_)),t.infoData_=new Io,t.infoSyncTree_=new Er({startListening:(i,r,s,o)=>{let a=[],l=t.infoData_.getNode(i._path);return l.isEmpty()||(a=Xn(t.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Aa(t,"connected",!1),t.serverSyncTree_=new Er({startListening:(i,r,s,o)=>(t.server_.listen(i,s,r,(a,l)=>{let c=o(a,l);ce(t.eventQueue_,i._path,c)}),[]),stopListening:(i,r)=>{t.server_.unlisten(i,r)}})}function ld(t){let n=t.infoData_.getNode(new x(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function ti(t){return vv({timestamp:ld(t)})}function ih(t,e,n,i,r){t.dataUpdateCount++;let s=new x(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(i){let l=on(n,c=>j(c));o=dv(t.serverSyncTree_,s,l,r)}else{let l=j(n);o=Kh(t.serverSyncTree_,s,l,r)}else if(i){let l=on(n,c=>j(c));o=cv(t.serverSyncTree_,s,l)}else{let l=j(n);o=Xn(t.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=Kt(t,s)),ce(t.eventQueue_,a,o)}function rh(t,e){Aa(t,"connected",e),e===!1&&Mv(t)}function Pv(t,e){q(e,(n,i)=>{Aa(t,n,i)})}function Aa(t,e,n){let i=new x("/.info/"+e),r=j(n);t.infoData_.updateSnapshot(i,r);let s=Xn(t.infoSyncTree_,i,r);ce(t.eventQueue_,i,s)}function Br(t){return t.nextWriteId_++}function Ov(t,e,n){let i=fv(t.serverSyncTree_,e);return i!=null?Promise.resolve(i):t.server_.get(e).then(r=>{let s=j(r).withIndex(e._queryParams.getIndex());Bo(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Xn(t.serverSyncTree_,e._path,s);else{let a=Hn(t.serverSyncTree_,e);o=Kh(t.serverSyncTree_,e._path,s,a)}return ce(t.eventQueue_,e._path,o),Cr(t.serverSyncTree_,e,n,null,!0),s},r=>(tn(t,"get for query "+H(e)+" failed: "+r),Promise.reject(new Error(r))))}function Na(t,e,n,i,r){tn(t,"set",{path:e.toString(),value:n,priority:i});let s=ti(t),o=j(n,i),a=Mr(t.serverSyncTree_,e),l=Ia(o,a,s),c=Br(t),u=Ea(t.serverSyncTree_,e,l,c,!0);jr(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(d,f)=>{let p=d==="ok";p||Q("set at "+e+" failed: "+d);let v=Je(t.serverSyncTree_,c,!p);ce(t.eventQueue_,e,v),rt(t,r,d,f)});let h=Oa(t,e);Kt(t,h),ce(t.eventQueue_,h,[])}function Dv(t,e,n,i){tn(t,"update",{path:e.toString(),value:n});let r=!0,s=ti(t),o={};if(q(n,(a,l)=>{r=!1,o[a]=Zh(F(e,a),j(l),t.serverSyncTree_,s)}),r)G("update() called with empty data.  Don't do anything."),rt(t,i,"ok",void 0);else{let a=Br(t),l=lv(t.serverSyncTree_,e,o,a);jr(t.eventQueue_,l),t.server_.merge(e.toString(),n,(c,u)=>{let h=c==="ok";h||Q("update at "+e+" failed: "+c);let d=Je(t.serverSyncTree_,a,!h),f=d.length>0?Kt(t,e):e;ce(t.eventQueue_,f,d),rt(t,i,c,u)}),q(n,c=>{let u=Oa(t,F(e,c));Kt(t,u)}),ce(t.eventQueue_,e,[])}}function Mv(t){tn(t,"onDisconnectEvents");let e=ti(t),n=fr();Ro(t.onDisconnect_,R(),(r,s)=>{let o=Zh(r,s,t.serverSyncTree_,e);Jt(n,r,o)});let i=[];Ro(n,R(),(r,s)=>{i=i.concat(Xn(t.serverSyncTree_,r,s));let o=Oa(t,r);Kt(t,o)}),t.onDisconnect_=fr(),ce(t.eventQueue_,R(),i)}function Lv(t,e,n){t.server_.onDisconnectCancel(e.toString(),(i,r)=>{i==="ok"&&So(t.onDisconnect_,e),rt(t,n,i,r)})}function sh(t,e,n,i){let r=j(n);t.server_.onDisconnectPut(e.toString(),r.val(!0),(s,o)=>{s==="ok"&&Jt(t.onDisconnect_,e,r),rt(t,i,s,o)})}function Fv(t,e,n,i,r){let s=j(n,i);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Jt(t.onDisconnect_,e,s),rt(t,r,o,a)})}function Uv(t,e,n,i){if(pi(n)){G("onDisconnect().update() called with empty data.  Don't do anything."),rt(t,i,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(r,s)=>{r==="ok"&&q(n,(o,a)=>{let l=j(a);Jt(t.onDisconnect_,F(e,o),l)}),rt(t,i,r,s)})}function Wv(t,e,n){let i;C(e._path)===".info"?i=Bo(t.infoSyncTree_,e,n):i=Bo(t.serverSyncTree_,e,n),sd(t.eventQueue_,e._path,i)}function qo(t,e,n){let i;C(e._path)===".info"?i=Cr(t.infoSyncTree_,e,n):i=Cr(t.serverSyncTree_,e,n),sd(t.eventQueue_,e._path,i)}function cd(t){t.persistentConnection_&&t.persistentConnection_.interrupt(ad)}function jv(t){t.persistentConnection_&&t.persistentConnection_.resume(ad)}function tn(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),G(n,...e)}function rt(t,e,n,i){e&&Xt(()=>{if(n==="ok")e(null);else{let r=(n||"error").toUpperCase(),s=r;i&&(s+=": "+i);let o=new Error(s);o.code=r,e(o)}})}function Bv(t,e,n,i,r,s){tn(t,"transaction on "+e);let o={path:e,update:n,onComplete:i,status:null,order:lh(),applyLocally:s,retryCount:0,unwatcher:r,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=Pa(t,e,void 0);o.currentInputSnapshot=a;let l=o.update(a.val());if(l===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Zn("transaction failed: Data returned ",l,o.path),o.status=0;let c=Fr(t.transactionQueueTree_,e),u=bt(c)||[];u.push(o),Ra(c,u);let h;typeof l=="object"&&l!==null&&pe(l,".priority")?(h=$e(l,".priority"),m($n(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(Mr(t.serverSyncTree_,e)||w.EMPTY_NODE).getPriority().val();let d=ti(t),f=j(l,h),p=Ia(f,a,d);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=Br(t);let v=Ea(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);ce(t.eventQueue_,e,v),zr(t,t.transactionQueueTree_)}}function Pa(t,e,n){return Mr(t.serverSyncTree_,e,n)||w.EMPTY_NODE}function zr(t,e=t.transactionQueueTree_){if(e||Hr(t,e),bt(e)){let n=hd(t,e);m(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&zv(t,Jn(e),n)}else ed(e)&&Ur(e,n=>{zr(t,n)})}function zv(t,e,n){let i=n.map(c=>c.currentWriteId),r=Pa(t,e,i),s=r,o=r.hash();for(let c=0;c<n.length;c++){let u=n[c];m(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let h=Z(e,u.path);s=s.updateChild(h,u.currentOutputSnapshotRaw)}let a=s.val(!0),l=e;t.server_.put(l.toString(),a,c=>{tn(t,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){let h=[];for(let d=0;d<n.length;d++)n[d].status=2,u=u.concat(Je(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&h.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();Hr(t,Fr(t.transactionQueueTree_,e)),zr(t,t.transactionQueueTree_),ce(t.eventQueue_,e,u);for(let d=0;d<h.length;d++)Xt(h[d])}else{if(c==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{Q("transaction at "+l.toString()+" failed: "+c);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=c}Kt(t,e)}},o)}function Kt(t,e){let n=ud(t,e),i=Jn(n),r=hd(t,n);return Hv(t,r,i),i}function Hv(t,e,n){if(e.length===0)return;let i=[],r=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let l=e[a],c=Z(n,l.path),u=!1,h;if(m(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,h=l.abortReason,r=r.concat(Je(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=Av)u=!0,h="maxretry",r=r.concat(Je(t.serverSyncTree_,l.currentWriteId,!0));else{let d=Pa(t,l.path,o);l.currentInputSnapshot=d;let f=e[a].update(d.val());if(f!==void 0){Zn("transaction failed: Data returned ",f,l.path);let p=j(f);typeof f=="object"&&f!=null&&pe(f,".priority")||(p=p.updatePriority(d.getPriority()));let y=l.currentWriteId,A=ti(t),I=Ia(p,d,A);l.currentOutputSnapshotRaw=p,l.currentOutputSnapshotResolved=I,l.currentWriteId=Br(t),o.splice(o.indexOf(y),1),r=r.concat(Ea(t.serverSyncTree_,l.path,I,l.currentWriteId,l.applyLocally)),r=r.concat(Je(t.serverSyncTree_,y,!0))}else u=!0,h="nodata",r=r.concat(Je(t.serverSyncTree_,l.currentWriteId,!0))}ce(t.eventQueue_,n,r),r=[],u&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(h),!1,null))))}Hr(t,t.transactionQueueTree_);for(let a=0;a<i.length;a++)Xt(i[a]);zr(t,t.transactionQueueTree_)}function ud(t,e){let n,i=t.transactionQueueTree_;for(n=C(e);n!==null&&bt(i)===void 0;)i=Fr(i,n),e=P(e),n=C(e);return i}function hd(t,e){let n=[];return dd(t,e,n),n.sort((i,r)=>i.order-r.order),n}function dd(t,e,n){let i=bt(e);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);Ur(e,r=>{dd(t,r,n)})}function Hr(t,e){let n=bt(e);if(n){let i=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[i]=n[r],i++);n.length=i,Ra(e,n.length>0?n:void 0)}Ur(e,i=>{Hr(t,i)})}function Oa(t,e){let n=Jn(ud(t,e)),i=Fr(t.transactionQueueTree_,e);return Ev(i,r=>{to(t,r)}),to(t,i),td(i,r=>{to(t,r)}),n}function to(t,e){let n=bt(e);if(n){let i=[],r=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(m(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(m(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(Je(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&i.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?Ra(e,void 0):n.length=s+1,ce(t.eventQueue_,Jn(e),r);for(let o=0;o<i.length;o++)Xt(i[o])}}function Vv(t){let e="",n=t.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let r=n[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function $v(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let i=n.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Q(`Invalid query segment '${n}' in query '${t}'`)}return e}var Yo=function(t,e){let n=Gv(t),i=n.namespace;n.domain==="firebase.com"&&Pe(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&Pe("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||Eg();let r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new sr(n.host,n.secure,i,r,e,"",i!==n.subdomain),path:new x(n.pathString)}},Gv=function(t){let e="",n="",i="",r="",s="",o=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let u=t.indexOf("/");u===-1&&(u=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(u,h)),u<h&&(r=Vv(t.substring(u,h)));let d=$v(t.substring(Math.min(t.length,h)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;let f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");i=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=i}"ns"in d&&(s=d.ns)}return{host:e,port:l,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};var oh="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",qv=function(){let t=0,e=[];return function(n){let i=n===t;t=n;let r,s=new Array(8);for(r=7;r>=0;r--)s[r]=oh.charAt(n%64),n=Math.floor(n/64);m(n===0,"Cannot push at time == 0");let o=s.join("");if(i){for(r=11;r>=0&&e[r]===63;r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(Math.random()*64);for(r=0;r<12;r++)o+=oh.charAt(e[r]);return m(o.length===20,"nextPushId: Length should be 20."),o}}();var Tr=class{constructor(e,n,i,r){this.eventType=e,this.eventRegistration=n,this.snapshot=i,this.prevName=r}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+H(this.snapshot.exportVal())}},kr=class{constructor(e,n,i){this.eventRegistration=e,this.error=n,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Gn=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return m(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Ir=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new X;return Lv(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){le("OnDisconnect.remove",this._path);let e=new X;return sh(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){le("OnDisconnect.set",this._path),De("OnDisconnect.set",e,this._path,!1);let n=new X;return sh(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){le("OnDisconnect.setWithPriority",this._path),De("OnDisconnect.setWithPriority",e,this._path,!1),xa("OnDisconnect.setWithPriority",n,!1);let i=new X;return Fv(this._repo,this._path,e,n,i.wrapCallback(()=>{})),i.promise}update(e){le("OnDisconnect.update",this._path),id("OnDisconnect.update",e,this._path,!1);let n=new X;return Uv(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var te=class t{constructor(e,n,i,r){this._repo=e,this._path=n,this._queryParams=i,this._orderByCalled=r}get key(){return T(this._path)?null:ha(this._path)}get ref(){return new ue(this._repo,this._path)}get _queryIdentifier(){let e=Gu(this._queryParams),n=ca(e);return n==="{}"?"default":n}get _queryObject(){return Gu(this._queryParams)}isEqual(e){if(e=U(e),!(e instanceof t))return!1;let n=this._repo===e._repo,i=da(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+e_(this._path)}};function Vr(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function ot(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Ne){let i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==tt)throw new Error(i);if(typeof e!="string")throw new Error(r)}if(t.hasEnd()){if(t.getIndexEndName()!==Be)throw new Error(i);if(typeof n!="string")throw new Error(r)}}else if(t.getIndex()===O){if(e!=null&&!$n(e)||n!=null&&!$n(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(m(t.getIndex()instanceof Ln||t.getIndex()===ma,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function $r(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var ue=class t extends te{constructor(e,n){super(e,n,new jn,!1)}get parent(){let e=xh(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Qt=class t{constructor(e,n,i){this._node=e,this.ref=n,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new x(e),i=st(this.ref,e);return new t(this._node.getChild(n),i,O)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,r)=>e(new t(r,st(this.ref,i),O)))}hasChild(e){let n=new x(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function Da(t,e){return t=U(t),t._checkNotDeleted("ref"),e!==void 0?st(t._root,e):t._root}function Ma(t,e){t=U(t),t._checkNotDeleted("refFromURL");let n=Yo(e,t._repo.repoInfo_.nodeAdmin);rd("refFromURL",n);let i=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&i.host!==t._repo.repoInfo_.host&&Pe("refFromURL: Host name does not match the current database: (found "+i.host+" but expected "+t._repo.repoInfo_.host+")"),Da(t,n.path.toString())}function st(t,e){return t=U(t),C(t._path)===null?Rv("child","path",e,!1):en("child","path",e,!1),new ue(t._repo,F(t._path,e))}function fd(t,e){t=U(t),le("push",t._path),De("push",e,t._path,!0);let n=ld(t._repo),i=qv(n),r=st(t,i),s=st(t,i),o;return e!=null?o=Gr(s,e).then(()=>s):o=Promise.resolve(s),r.then=o.then.bind(o),r.catch=o.then.bind(o,void 0),r}function pd(t){return le("remove",t._path),Gr(t,null)}function Gr(t,e){t=U(t),le("set",t._path),De("set",e,t._path,!1);let n=new X;return Na(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function md(t,e){t=U(t),le("setPriority",t._path),xa("setPriority",e,!1);let n=new X;return Na(t._repo,F(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function gd(t,e,n){if(le("setWithPriority",t._path),De("setWithPriority",e,t._path,!1),xa("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let i=new X;return Na(t._repo,t._path,e,n,i.wrapCallback(()=>{})),i.promise}function _d(t,e){id("update",e,t._path,!1);let n=new X;return Dv(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function vd(t){t=U(t);let e=new Gn(()=>{}),n=new qn(e);return Ov(t._repo,t,n).then(i=>new Qt(i,new ue(t._repo,t._path),t._queryParams.getIndex()))}var qn=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let i=n._queryParams.getIndex();return new Tr("value",this,new Qt(e.snapshotNode,new ue(n._repo,n._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new kr(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},Sr=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new kr(this,e,n):null}createEvent(e,n){m(e.childName!=null,"Child events should have a childName.");let i=st(new ue(n._repo,n._path),e.childName),r=n._queryParams.getIndex();return new Tr(e.type,this,new Qt(e.snapshotNode,i,r),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function ni(t,e,n,i,r){let s;if(typeof i=="object"&&(s=void 0,r=i),typeof i=="function"&&(s=i),r&&r.onlyOnce){let l=n,c=(u,h)=>{qo(t._repo,t,a),l(u,h)};c.userCallback=n.userCallback,c.context=n.context,n=c}let o=new Gn(n,s||void 0),a=e==="value"?new qn(o):new Sr(e,o);return Wv(t._repo,t,a),()=>qo(t._repo,t,a)}function qr(t,e,n,i){return ni(t,"value",e,n,i)}function La(t,e,n,i){return ni(t,"child_added",e,n,i)}function Fa(t,e,n,i){return ni(t,"child_changed",e,n,i)}function Ua(t,e,n,i){return ni(t,"child_moved",e,n,i)}function Wa(t,e,n,i){return ni(t,"child_removed",e,n,i)}function ja(t,e,n){let i=null,r=n?new Gn(n):null;e==="value"?i=new qn(r):e&&(i=new Sr(e,r)),qo(t._repo,t,i)}var he=class{},Rr=class extends he{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){De("endAt",this._value,e._path,!0);let n=To(e._queryParams,this._value,this._key);if($r(n),ot(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new te(e._repo,e._path,n,e._orderByCalled)}};function yd(t,e){return ei("endAt","key",e,!0),new Rr(t,e)}var Ko=class extends he{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){De("endBefore",this._value,e._path,!1);let n=y_(e._queryParams,this._value,this._key);if($r(n),ot(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new te(e._repo,e._path,n,e._orderByCalled)}};function bd(t,e){return ei("endBefore","key",e,!0),new Ko(t,e)}var xr=class extends he{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){De("startAt",this._value,e._path,!0);let n=Co(e._queryParams,this._value,this._key);if($r(n),ot(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new te(e._repo,e._path,n,e._orderByCalled)}};function wd(t=null,e){return ei("startAt","key",e,!0),new xr(t,e)}var Qo=class extends he{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){De("startAfter",this._value,e._path,!1);let n=v_(e._queryParams,this._value,this._key);if($r(n),ot(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new te(e._repo,e._path,n,e._orderByCalled)}};function Ed(t,e){return ei("startAfter","key",e,!0),new Qo(t,e)}var Xo=class extends he{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new te(e._repo,e._path,g_(e._queryParams,this._limit),e._orderByCalled)}};function Cd(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Xo(t)}var Jo=class extends he{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new te(e._repo,e._path,__(e._queryParams,this._limit),e._orderByCalled)}};function Td(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Jo(t)}var Zo=class extends he{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Vr(e,"orderByChild");let n=new x(this._path);if(T(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let i=new Ln(n),r=Nr(e._queryParams,i);return ot(r),new te(e._repo,e._path,r,!0)}};function kd(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return en("orderByChild","path",t,!1),new Zo(t)}var ea=class extends he{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Vr(e,"orderByKey");let n=Nr(e._queryParams,Ne);return ot(n),new te(e._repo,e._path,n,!0)}};function Id(){return new ea}var ta=class extends he{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Vr(e,"orderByPriority");let n=Nr(e._queryParams,O);return ot(n),new te(e._repo,e._path,n,!0)}};function Sd(){return new ta}var na=class extends he{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Vr(e,"orderByValue");let n=Nr(e._queryParams,ma);return ot(n),new te(e._repo,e._path,n,!0)}};function Rd(){return new na}var ia=class extends he{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(De("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Rr(this._value,this._key)._apply(new xr(this._value,this._key)._apply(e))}};function xd(t,e){return ei("equalTo","key",e,!0),new ia(t,e)}function _e(t,...e){let n=U(t);for(let i of e)n=i._apply(n);return n}ev(ue);sv(ue);var Yv="FIREBASE_DATABASE_EMULATOR_HOST",ra={},Kv=!1;function Qv(t,e,n,i){t.repoInfo_=new sr(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),i&&(t.authTokenProvider_=i)}function Ba(t,e,n,i,r){let s=i||t.options.databaseURL;s===void 0&&(t.options.projectId||Pe("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),G("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Yo(s,r),a=o.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[Yv]),c?(l=!0,s=`http://${c}?ns=${a.namespace}`,o=Yo(s,r),a=o.repoInfo):l=!o.repoInfo.secure;let u=r&&l?new An(An.OWNER):new ao(t.name,t.options,e);rd("Invalid Firebase Database URL",o),T(o.path)||Pe("Database URL must point to the root of a Firebase Database (not including a child path).");let h=Jv(a,t,u,new oo(t.name,n));return new sa(h,t)}function Xv(t,e){let n=ra[e];(!n||n[t.key]!==t)&&Pe(`Database ${e}(${t.repoInfo_}) has already been deleted.`),cd(t),delete n[t.key]}function Jv(t,e,n,i){let r=ra[e.name];r||(r={},ra[e.name]=r);let s=r[t.toURLString()];return s&&Pe("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Go(t,Kv,n,i),r[t.toURLString()]=s,s}var sa=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Nv(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ue(this._repo,R())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Xv(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Pe("Cannot call "+e+" on a deleted database.")}};function Ad(){Rh.IS_TRANSPORT_INITIALIZED&&Q("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Nd(){Ad(),Dn.forceDisallow()}function Pd(){Ad(),jt.forceDisallow(),Dn.forceAllow()}function Od(t,e,n,i={}){t=U(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Pe("Cannot call useEmulator() after instance has already been initialized.");let r=t._repoInternal,s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&Pe('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new An(An.OWNER);else if(i.mockUserToken){let o=typeof i.mockUserToken=="string"?i.mockUserToken:di(i.mockUserToken,t.app.options.projectId);s=new An(o)}Qv(r,e,n,s)}function Dd(t){t=U(t),t._checkNotDeleted("goOffline"),cd(t._repo)}function Md(t){t=U(t),t._checkNotDeleted("goOnline"),jv(t._repo)}function Ld(t,e){uh(t,e)}function Zv(t){la(vi),_i(new ke("database",(e,{instanceIdentifier:n})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return Ba(i,r,s,n)},"PUBLIC").setMultipleInstances(!0)),kt(xu,Au,t),kt(xu,Au,"esm2017")}var ey={".sv":"timestamp"};function Fd(){return ey}function Ud(t){return{".sv":{increment:t}}}var oa=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function Wd(t,e,n){var i;if(t=U(t),le("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let r=(i=n?.applyLocally)!==null&&i!==void 0?i:!0,s=new X,o=(l,c,u)=>{let h=null;l?s.reject(l):(h=new Qt(u,new ue(t._repo,t._path),O),s.resolve(new oa(c,h)))},a=qr(t,()=>{});return Bv(t._repo,t._path,e,o,a,r),s.promise}fa.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};fa.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};Zv();var ty="@firebase/database-compat",ny="1.0.3";var iy=new gi("@firebase/database-compat"),jd=function(t){let e="FIREBASE WARNING: "+t;iy.warn(e)};var ry=function(t,e,n,i){if(!(i&&n===void 0)&&typeof n!="boolean")throw new Error(se(t,e)+"must be a boolean.")},sy=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(se(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var za=class{constructor(e){this._delegate=e}cancel(e){b("OnDisconnect.cancel",0,1,arguments.length),V("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),i=>e(i)),n}remove(e){b("OnDisconnect.remove",0,1,arguments.length),V("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),i=>e(i)),n}set(e,n){b("OnDisconnect.set",1,2,arguments.length),V("OnDisconnect.set","onComplete",n,!0);let i=this._delegate.set(e);return n&&i.then(()=>n(null),r=>n(r)),i}setWithPriority(e,n,i){b("OnDisconnect.setWithPriority",2,3,arguments.length),V("OnDisconnect.setWithPriority","onComplete",i,!0);let r=this._delegate.setWithPriority(e,n);return i&&r.then(()=>i(null),s=>i(s)),r}update(e,n){if(b("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let r={};for(let s=0;s<e.length;++s)r[""+s]=e[s];e=r,jd("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}V("OnDisconnect.update","onComplete",n,!0);let i=this._delegate.update(e);return n&&i.then(()=>n(null),r=>n(r)),i}};var Ha=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return b("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var wt=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return b("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return b("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return b("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return b("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return b("DataSnapshot.child",0,1,arguments.length),e=String(e),en("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return b("DataSnapshot.hasChild",1,1,arguments.length),en("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return b("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return b("DataSnapshot.forEach",1,1,arguments.length),V("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return b("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return b("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return b("DataSnapshot.ref",0,0,arguments.length),new ze(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Yr=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,i,r){var s;b("Query.on",2,4,arguments.length),V("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",i,r),a=(c,u)=>{n.call(o.context,new wt(this.database,c),u)};a.userCallback=n,a.context=o.context;let l=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return qr(this._delegate,a,l),n;case"child_added":return La(this._delegate,a,l),n;case"child_removed":return Wa(this._delegate,a,l),n;case"child_changed":return Fa(this._delegate,a,l),n;case"child_moved":return Ua(this._delegate,a,l),n;default:throw new Error(se("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,i){if(b("Query.off",0,3,arguments.length),sy("Query.off",e,!0),V("Query.off","callback",n,!0),ts("Query.off","context",i,!0),n){let r=()=>{};r.userCallback=n,r.context=i,ja(this._delegate,e,r)}else ja(this._delegate,e)}get(){return vd(this._delegate).then(e=>new wt(this.database,e))}once(e,n,i,r){b("Query.once",1,4,arguments.length),V("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",i,r),o=new X,a=(c,u)=>{let h=new wt(this.database,c);n&&n.call(s.context,h,u),o.resolve(h)};a.userCallback=n,a.context=s.context;let l=c=>{s.cancel&&s.cancel.call(s.context,c),o.reject(c)};switch(e){case"value":qr(this._delegate,a,l,{onlyOnce:!0});break;case"child_added":La(this._delegate,a,l,{onlyOnce:!0});break;case"child_removed":Wa(this._delegate,a,l,{onlyOnce:!0});break;case"child_changed":Fa(this._delegate,a,l,{onlyOnce:!0});break;case"child_moved":Ua(this._delegate,a,l,{onlyOnce:!0});break;default:throw new Error(se("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return b("Query.limitToFirst",1,1,arguments.length),new t(this.database,_e(this._delegate,Cd(e)))}limitToLast(e){return b("Query.limitToLast",1,1,arguments.length),new t(this.database,_e(this._delegate,Td(e)))}orderByChild(e){return b("Query.orderByChild",1,1,arguments.length),new t(this.database,_e(this._delegate,kd(e)))}orderByKey(){return b("Query.orderByKey",0,0,arguments.length),new t(this.database,_e(this._delegate,Id()))}orderByPriority(){return b("Query.orderByPriority",0,0,arguments.length),new t(this.database,_e(this._delegate,Sd()))}orderByValue(){return b("Query.orderByValue",0,0,arguments.length),new t(this.database,_e(this._delegate,Rd()))}startAt(e=null,n){return b("Query.startAt",0,2,arguments.length),new t(this.database,_e(this._delegate,wd(e,n)))}startAfter(e=null,n){return b("Query.startAfter",0,2,arguments.length),new t(this.database,_e(this._delegate,Ed(e,n)))}endAt(e=null,n){return b("Query.endAt",0,2,arguments.length),new t(this.database,_e(this._delegate,yd(e,n)))}endBefore(e=null,n){return b("Query.endBefore",0,2,arguments.length),new t(this.database,_e(this._delegate,bd(e,n)))}equalTo(e,n){return b("Query.equalTo",1,2,arguments.length),new t(this.database,_e(this._delegate,xd(e,n)))}toString(){return b("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return b("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(b("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,i){let r={cancel:void 0,context:void 0};if(n&&i)r.cancel=n,V(e,"cancel",r.cancel,!0),r.context=i,ts(e,"context",r.context,!0);else if(n)if(typeof n=="object"&&n!==null)r.context=n;else if(typeof n=="function")r.cancel=n;else throw new Error(se(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return r}get ref(){return new ze(this.database,new ue(this._delegate._repo,this._delegate._path))}},ze=class t extends Yr{constructor(e,n){super(e,new te(n._repo,n._path,new jn,!1)),this.database=e,this._delegate=n}getKey(){return b("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return b("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,st(this._delegate,e))}getParent(){b("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return b("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){b("Reference.set",1,2,arguments.length),V("Reference.set","onComplete",n,!0);let i=Gr(this._delegate,e);return n&&i.then(()=>n(null),r=>n(r)),i}update(e,n){if(b("Reference.update",1,2,arguments.length),Array.isArray(e)){let r={};for(let s=0;s<e.length;++s)r[""+s]=e[s];e=r,jd("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}le("Reference.update",this._delegate._path),V("Reference.update","onComplete",n,!0);let i=_d(this._delegate,e);return n&&i.then(()=>n(null),r=>n(r)),i}setWithPriority(e,n,i){b("Reference.setWithPriority",2,3,arguments.length),V("Reference.setWithPriority","onComplete",i,!0);let r=gd(this._delegate,e,n);return i&&r.then(()=>i(null),s=>i(s)),r}remove(e){b("Reference.remove",0,1,arguments.length),V("Reference.remove","onComplete",e,!0);let n=pd(this._delegate);return e&&n.then(()=>e(null),i=>e(i)),n}transaction(e,n,i){b("Reference.transaction",1,3,arguments.length),V("Reference.transaction","transactionUpdate",e,!1),V("Reference.transaction","onComplete",n,!0),ry("Reference.transaction","applyLocally",i,!0);let r=Wd(this._delegate,e,{applyLocally:i}).then(s=>new Ha(s.committed,new wt(this.database,s.snapshot)));return n&&r.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),r}setPriority(e,n){b("Reference.setPriority",1,2,arguments.length),V("Reference.setPriority","onComplete",n,!0);let i=md(this._delegate,e);return n&&i.then(()=>n(null),r=>n(r)),i}push(e,n){b("Reference.push",0,2,arguments.length),V("Reference.push","onComplete",n,!0);let i=fd(this._delegate,e),r=i.then(o=>new t(this.database,o));n&&r.then(()=>n(null),o=>n(o));let s=new t(this.database,i);return s.then=r.then.bind(r),s.catch=r.catch.bind(r,void 0),s}onDisconnect(){return le("Reference.onDisconnect",this._delegate._path),new za(new Ir(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Et=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:Nd,forceLongPolling:Pd}}useEmulator(e,n,i={}){Od(this._delegate,e,n,i)}ref(e){if(b("database.ref",0,1,arguments.length),e instanceof ze){let n=Ma(this._delegate,e.toString());return new ze(this,n)}else{let n=Da(this._delegate,e);return new ze(this,n)}}refFromURL(e){b("database.refFromURL",1,1,arguments.length);let i=Ma(this._delegate,e);return new ze(this,i)}goOffline(){return b("database.goOffline",0,0,arguments.length),Dd(this._delegate)}goOnline(){return b("database.goOnline",0,0,arguments.length),Md(this._delegate)}};Et.ServerValue={TIMESTAMP:Fd(),increment:t=>Ud(t)};function oy({app:t,url:e,version:n,customAuthImpl:i,customAppCheckImpl:r,namespace:s,nodeAdmin:o=!1}){la(n);let a=new ns("database-standalone"),l=new mi("auth-internal",a);l.setComponent(new ke("auth-internal",()=>i,"PRIVATE"));let c;return r&&(c=new mi("app-check-internal",a),c.setComponent(new ke("app-check-internal",()=>r,"PRIVATE"))),{instance:new Et(Ba(t,l,c,e,o),t),namespace:s}}var ay=Object.freeze({__proto__:null,initStandalone:oy});var ly=Et.ServerValue;function cy(t){t.INTERNAL.registerComponent(new ke("database-compat",(e,{instanceIdentifier:n})=>{let i=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database").getImmediate({identifier:n});return new Et(r,i)},"PUBLIC").setServiceProps({Reference:ze,Query:Yr,Database:Et,DataSnapshot:wt,enableLogging:Ld,INTERNAL:ay,ServerValue:ly}).setMultipleInstances(!0)),t.registerVersion(ty,ny)}cy(Le);function ii(t,e,n="on",i=Ga){return new ri(r=>{let s=null;return s=t[n](e,(o,a)=>{i.schedule(()=>{r.next({snapshot:o,prevKey:a})}),n==="once"&&i.schedule(()=>r.complete())},o=>{i.schedule(()=>r.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(fe(r=>{let{snapshot:s,prevKey:o}=r,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Qa())}function uy(t){return typeof t=="string"}function hy(t){return typeof t.exportVal=="function"}function $d(t){return t==null}function Gd(t){return typeof t.set=="function"}function Bd(t,e){return Gd(e)?e:t.ref(e)}function qd(t,e){if(uy(t))return e.stringCase();if(Gd(t))return e.firebaseCase();if(hy(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function Yd(t){return($d(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function Kd(t,e,n){e=Yd(e);let i=e.map(r=>ii(t,r,"on",n));return Kr(...i)}function dy(t,e,n){let i=Kd(t,e).pipe(Qr((r,s)=>[...r,s],[]));return py(t,i,n)}function fy(t,e){return ii(t,"value","on",e).pipe(fe(n=>{let i;return n.payload.forEach(r=>(i=r.key,!1)),{data:n,lastKeyToLoad:i}}))}function py(t,e,n){return fy(t,n).pipe(Ja(e),fe(([r,s])=>{let o=r.lastKeyToLoad,a=s.map(l=>l.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),Xa(r=>r.loadedKeys.indexOf(r.lastKeyToLoad)===-1),fe(r=>r.actions))}function zd(t,e){return function(i,r){return qd(i,{stringCase:()=>t.child(i)[e](r),firebaseCase:()=>i[e](r),snapshotCase:()=>i.ref[e](r)})}}function my(t){return function(n){return n?qd(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function gy(t,e,n){return ii(t,"value","once",n).pipe(Ct(i=>{let r=[rn(i)];return e.forEach(s=>r.push(ii(t,s,"on",n))),Kr(...r).pipe(Qr(vy,[]))}),Ka())}function Qd(t,e){let n=t.length;for(let i=0;i<n;i++)if(t[i].payload.key===e)return i;return-1}function _y(t,e){if($d(e))return 0;{let n=Qd(t,e);return n===-1?t.length:n+1}}function vy(t,e){let{payload:n,prevKey:i,key:r}=e,s=Qd(t,r),o=_y(t,i);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(l=>{let c={payload:l,type:"value",prevKey:a,key:l.key};return a=l.key,t=[...t,c],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==i&&(t=t.filter(l=>l.payload.key!==n.key),t.splice(o,0,e));else{if(i==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===r?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function Hd(t,e,n){return e=Yd(e),gy(t,e,n)}function yy(t,e){let n=e.schedulers.outsideAngular,i=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:zd(i,"update"),set:zd(i,"set"),push:r=>i.push(r),remove:my(i),snapshotChanges(r){return Hd(t,r,n).pipe(Ie)},stateChanges(r){return Kd(t,r,n).pipe(Ie)},auditTrail(r){return dy(t,r,n).pipe(Ie)},valueChanges(r,s){return Hd(t,r,n).pipe(fe(a=>a.map(l=>s&&s.idField?$a(Va({},l.payload.val()),{[s.idField]:l.key}):l.payload.val())),Ie)}}}function Vd(t,e){return function(){return ii(t,"value","on",e)}}function by(t,e){return{query:t,snapshotChanges(){return Vd(t,e.schedulers.outsideAngular)().pipe(Ie)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return Vd(t,e.schedulers.outsideAngular)().pipe(Ie,fe(i=>i.payload.exists()?i.payload.val():null))}}}var wy=new He("angularfire2.realtimeDatabaseURL"),Ey=new He("angularfire2.database.use-emulator"),Cy=(()=>{class t{schedulers;database;constructor(n,i,r,s,o,a,l,c,u,h,d,f,p,v,y){this.schedulers=a;let A=l,I=Ti(n,o,i);c&&Il(I,o,u,d,f,p,h,v),this.database=ki(`${I.name}.database.${r}`,"AngularFireDatabase",I.name,()=>{let E=o.runOutsideAngular(()=>I.database(r||void 0));return A&&E.useEmulator(...A),E},[A])}list(n,i){let r=this.schedulers.ngZone.runOutsideAngular(()=>Bd(this.database,n)),s=r;return i&&(s=i(r)),yy(s,this)}object(n){let i=this.schedulers.ngZone.runOutsideAngular(()=>Bd(this.database,n));return by(i,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(i){return new(i||t)(S(Ei),S(Ci,8),S(wy,8),S(oi),S(Ve),S(wi),S(Ey,8),S(Ii,8),S(bl,8),S(wl,8),S(El,8),S(Cl,8),S(Tl,8),S(kl,8),S(bi,8))};static \u0275prov=ye({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),Xd=(()=>{class t{constructor(){Le.registerVersion("angularfire",yi.full,"rtdb-compat")}static \u0275fac=function(i){return new(i||t)};static \u0275mod=re({type:t});static \u0275inj=ie({providers:[Cy]})}return t})();var Jd={production:!1,firebase:{apiKey:"AIzaSyBfvUz5hmwQmxENmSr-FMmlpXhN4hMh4Z4",authDomain:"vocabularioapp-de800.firebaseapp.com",projectId:"vocabularioapp-de800",storageBucket:"vocabularioapp-de800.appspot.com",messagingSenderId:"971549967648",appId:"1:971549967648:web:3d599643f96d916107c345",measurementId:"G-15TKQLWYHZ"}};var Zd=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=re({type:e,bootstrap:[Wl]}),e.\u0275inj=ie({providers:[sl(),Hc(),xl],imports:[hi,Ul,Wc,il,Al,zc,Pl,Nl,yl.initializeApp(Jd.firebase),Xd,Sl,Rl,Ru]});let t=e;return t})();rl().bootstrapModule(Zd).catch(t=>console.error(t));
